<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: Core</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules__0dangular-devkit_build-angular_node_modules__0dangular-devkit_core__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Core </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p>Shared utilities for Angular DevKit. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md777"></a>
Exception</h1>
<h1><a class="anchor" id="autotoc_md778"></a>
Json</h1>
<h2><a class="anchor" id="autotoc_md779"></a>
Schema</h2>
<h3><a class="anchor" id="autotoc_md780"></a>
SchemaValidatorResult</h3>
<div class="fragment"><div class="line">export interface SchemaValidatorResult {</div>
<div class="line">  success: boolean;</div>
<div class="line">  errors?: string[];</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md781"></a>
SchemaValidator</h3>
<div class="fragment"><div class="line">export interface SchemaValidator {</div>
<div class="line">  (data: any): Observable&lt;SchemaValidatorResult&gt;;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md782"></a>
SchemaFormatter</h3>
<div class="fragment"><div class="line">export interface SchemaFormatter {</div>
<div class="line">  readonly async: boolean;</div>
<div class="line">  validate(data: any): boolean | Observable&lt;boolean&gt;;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md783"></a>
SchemaRegistry</h3>
<div class="fragment"><div class="line">export interface SchemaRegistry {</div>
<div class="line">  compile(schema: Object): Observable&lt;SchemaValidator&gt;;</div>
<div class="line">  addFormat(name: string, formatter: SchemaFormatter): void;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md784"></a>
CoreSchemaRegistry</h3>
<p><code>SchemaRegistry</code> implementation using <a href="https://github.com/epoberezkin/ajv">https://github.com/epoberezkin/ajv</a>. Constructor accepts object containing <code>SchemaFormatter</code> that will be added automatically.</p>
<div class="fragment"><div class="line">export class CoreSchemaRegistry implements SchemaRegistry {</div>
<div class="line">  constructor(formats: { [name: string]: SchemaFormatter} = {}) {}</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md785"></a>
Logger</h1>
<h1><a class="anchor" id="autotoc_md786"></a>
Utils</h1>
<h1><a class="anchor" id="autotoc_md787"></a>
Virtual FS</h1>
<h1><a class="anchor" id="autotoc_md788"></a>
Workspaces</h1>
<p>The <code>workspaces</code> namespace provides an API for interacting with the workspace file formats. It provides an abstraction of the underlying storage format of the workspace and provides support for both reading and writing. Currently, the only supported format is the JSON-based format used by the Angular CLI. For this format, the API provides internal change tracking of values which enables fine-grained updates to the underlying storage of the workspace. This allows for the retention of existing formatting and comments.</p>
<p>A workspace is defined via the following object model. Definition collection objects are specialized Javascript <code>Map</code> objects with an additional <code>add</code> method to simplify addition and provide more localized error checking of the newly added values.</p>
<div class="fragment"><div class="line">export interface WorkspaceDefinition {</div>
<div class="line">    readonly extensions: Record&lt;string, JsonValue | undefined&gt;;</div>
<div class="line">    readonly projects: ProjectDefinitionCollection;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">export interface ProjectDefinition {</div>
<div class="line">    readonly extensions: Record&lt;string, JsonValue | undefined&gt;;</div>
<div class="line">    readonly targets: TargetDefinitionCollection;</div>
<div class="line">    root: string;</div>
<div class="line">    prefix?: string;</div>
<div class="line">    sourceRoot?: string;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">export interface TargetDefinition {</div>
<div class="line">    options?: Record&lt;string, JsonValue | undefined&gt;;</div>
<div class="line">    configurations?: Record&lt;string, Record&lt;string, JsonValue | undefined&gt; | undefined&gt;;</div>
<div class="line">    builder: string;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The API is asynchronous and has two main functions to facilitate reading, creation, and modifying a workspace: <code>readWorkspace</code> and <code>writeWorkspace</code>.</p>
<div class="fragment"><div class="line">export enum WorkspaceFormat {</div>
<div class="line">  JSON,</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">export function readWorkspace(</div>
<div class="line">  path: string,</div>
<div class="line">  host: WorkspaceHost,</div>
<div class="line">  format?: WorkspaceFormat,</div>
<div class="line">): Promise&lt;{ workspace: WorkspaceDefinition; }&gt;;</div>
</div><!-- fragment --><div class="fragment"><div class="line">export function writeWorkspace(</div>
<div class="line">  workspace: WorkspaceDefinition,</div>
<div class="line">  host: WorkspaceHost,</div>
<div class="line">  path?: string,</div>
<div class="line">  format?: WorkspaceFormat,</div>
<div class="line">): Promise&lt;void&gt;;</div>
</div><!-- fragment --><p>A <code>WorkspaceHost</code> abstracts the underlying data access methods from the functions. It provides methods to read, write, and analyze paths. A utility function is provided to create an instance of a <code>WorkspaceHost</code> from the Angular DevKit's virtual filesystem host abstraction.</p>
<div class="fragment"><div class="line">export interface WorkspaceHost {</div>
<div class="line">    readFile(path: string): Promise&lt;string&gt;;</div>
<div class="line">    writeFile(path: string, data: string): Promise&lt;void&gt;;</div>
<div class="line">    isDirectory(path: string): Promise&lt;boolean&gt;;</div>
<div class="line">    isFile(path: string): Promise&lt;boolean&gt;;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">export function createWorkspaceHost(host: virtualFs.Host): WorkspaceHost;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md789"></a>
Usage Example</h2>
<p>To demonstrate the usage of the API, the following code will show how to add a option property to a build target for an application.</p>
<div class="fragment"><div class="line">import { NodeJsSyncHost } from &#39;@angular-devkit/core/node&#39;;</div>
<div class="line">import { workspaces } from &#39;@angular-devkit/core&#39;;</div>
<div class="line"> </div>
<div class="line">async function demonstrate() {</div>
<div class="line">    const host = workspaces.createWorkspaceHost(new NodeJsSyncHost());</div>
<div class="line">    const { workspace } = await workspaces.readWorkspace(&#39;path/to/workspace/directory/&#39;, host);</div>
<div class="line"> </div>
<div class="line">    const project = workspace.projects.get(&#39;my-app&#39;);</div>
<div class="line">    if (!project) {</div>
<div class="line">      throw new Error(&#39;my-app does not exist&#39;);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    const buildTarget = project.targets.get(&#39;build&#39;);</div>
<div class="line">    if (!buildTarget) {</div>
<div class="line">      throw new Error(&#39;build target does not exist&#39;);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    buildTarget.options.optimization = true;</div>
<div class="line"> </div>
<div class="line">    await workspaces.writeWorkspace(workspace, host);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">demonstrate();</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
