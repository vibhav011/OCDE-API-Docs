<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: PostCSS Plugin Guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_resolve-url-loader_node_modules_postcss_docs_guidelines_plugin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PostCSS Plugin Guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A PostCSS plugin is a function that receives and, usually, transforms a CSS AST from the PostCSS parser.</p>
<p>The rules below are <em>mandatory</em> for all PostCSS plugins.</p>
<p>See also <a href="http://blog.clojurewerkz.org/blog/2013/04/20/how-to-make-your-open-source-project-really-awesome/">ClojureWerkz’s recommendations</a> for open source projects.</p>
<h1><a class="anchor" id="autotoc_md23829"></a>
1. API</h1>
<h2><a class="anchor" id="autotoc_md23830"></a>
1.1 Clear name with &lt;tt&gt;postcss-&lt;/tt&gt; prefix</h2>
<p>The plugin’s purpose should be clear just by reading its name. If you wrote a transpiler for CSS 4 Custom Media, <code>postcss-custom-media</code> would be a good name. If you wrote a plugin to support mixins, <code>postcss-mixins</code> would be a good name.</p>
<p>The prefix <code>postcss-</code> shows that the plugin is part of the PostCSS ecosystem.</p>
<p>This rule is not mandatory for plugins that can run as independent tools, without the user necessarily knowing that it is powered by PostCSS — for example, <a href="https://rtlcss.com/">RTLCSS</a> and <a href="https://github.com/postcss/autoprefixer">Autoprefixer</a>.</p>
<h2><a class="anchor" id="autotoc_md23831"></a>
1.2. Do one thing, and do it well</h2>
<p>Do not create multitool plugins. Several small, one-purpose plugins bundled into a plugin pack is usually a better solution.</p>
<p>For example, <a href="https://preset-env.cssdb.org/"><code>postcss-preset-env</code></a> contains many small plugins, one for each W3C specification. And <a href="https://github.com/ben-eb/cssnano"><code>cssnano</code></a> contains a separate plugin for each of its optimization.</p>
<h2><a class="anchor" id="autotoc_md23832"></a>
1.3. Do not use mixins</h2>
<p>Preprocessors libraries like Compass provide an API with mixins.</p>
<p>PostCSS plugins are different. A plugin cannot be just a set of mixins for <a href="https://github.com/postcss/postcss-mixins"><code>postcss-mixins</code></a>.</p>
<p>To achieve your goal, consider transforming valid CSS or using custom at-rules and custom properties.</p>
<h2><a class="anchor" id="autotoc_md23833"></a>
1.4. Create plugin by &lt;tt&gt;postcss.plugin&lt;/tt&gt;</h2>
<p>By wrapping your function in this method, you are hooking into a common plugin API:</p>
<div class="fragment"><div class="line">module.exports = postcss.plugin(&#39;plugin-name&#39;, opts =&gt; {</div>
<div class="line">  return (root, result) =&gt; {</div>
<div class="line">    // Plugin code</div>
<div class="line">  }</div>
<div class="line">})</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23834"></a>
2. Processing</h1>
<h2><a class="anchor" id="autotoc_md23835"></a>
2.1. Plugin must be tested</h2>
<p>A CI service like <a href="https://travis-ci.org/">Travis</a> is also recommended for testing code in different environments. You should test in (at least) Node.js <a href="https://github.com/nodejs/LTS">active LTS</a> and current stable version.</p>
<h2><a class="anchor" id="autotoc_md23836"></a>
2.2. Use asynchronous methods whenever possible</h2>
<p>For example, use <code>fs.writeFile</code> instead of <code>fs.writeFileSync</code>:</p>
<div class="fragment"><div class="line">postcss.plugin(&#39;plugin-sprite&#39;, opts =&gt; {</div>
<div class="line">  return (root, result) =&gt; {</div>
<div class="line"> </div>
<div class="line">    return new Promise((resolve, reject) =&gt; {</div>
<div class="line">      const sprite = makeSprite()</div>
<div class="line">      fs.writeFile(opts.file, sprite, err =&gt; {</div>
<div class="line">        if (err) return reject(err)</div>
<div class="line">        resolve()</div>
<div class="line">      })</div>
<div class="line">    })</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line">})</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23837"></a>
2.3. Set &lt;tt&gt;node.source&lt;/tt&gt; for new nodes</h2>
<p>Every node must have a relevant <code>source</code> so PostCSS can generate an accurate source map.</p>
<p>So if you add a new declaration based on some existing declaration, you should clone the existing declaration in order to save that original <code>source</code>.</p>
<div class="fragment"><div class="line">if (needPrefix(decl.prop)) {</div>
<div class="line">  decl.cloneBefore({ prop: &#39;-webkit-&#39; + decl.prop })</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can also set <code>source</code> directly, copying from some existing node:</p>
<div class="fragment"><div class="line">if (decl.prop === &#39;animation&#39;) {</div>
<div class="line">  const keyframe = createAnimationByName(decl.value)</div>
<div class="line">  keyframes.source = decl.source</div>
<div class="line">  decl.root().append(keyframes)</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23838"></a>
2.4. Use only the public PostCSS API</h2>
<p>PostCSS plugins must not rely on undocumented properties or methods, which may be subject to change in any minor release. The public API is described in <a href="http://api.postcss.org/">API docs</a>.</p>
<h1><a class="anchor" id="autotoc_md23839"></a>
3. Errors</h1>
<h2><a class="anchor" id="autotoc_md23840"></a>
3.1. Use &lt;tt&gt;node.error&lt;/tt&gt; on CSS relevant errors</h2>
<p>If you have an error because of input CSS (like an unknown name in a mixin plugin) you should use <code>node.error</code> to create an error that includes source position:</p>
<div class="fragment"><div class="line">if (typeof mixins[name] === &#39;undefined&#39;) {</div>
<div class="line">  throw decl.error(&#39;Unknown mixin &#39; + name, { plugin: &#39;postcss-mixins&#39; })</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23841"></a>
3.2. Use &lt;tt&gt;result.warn&lt;/tt&gt; for warnings</h2>
<p>Do not print warnings with <code>console.log</code> or <code>console.warn</code>, because some PostCSS runner may not allow console output.</p>
<div class="fragment"><div class="line">if (outdated(decl.prop)) {</div>
<div class="line">  result.warn(decl.prop + &#39; is outdated&#39;, { node: decl })</div>
<div class="line">}</div>
</div><!-- fragment --><p>If CSS input is a source of the warning, the plugin must set the <code>node</code> option.</p>
<h1><a class="anchor" id="autotoc_md23842"></a>
4. Documentation</h1>
<h2><a class="anchor" id="autotoc_md23843"></a>
4.1. Document your plugin in English</h2>
<p>PostCSS plugins must have their <code>README.md</code> wrote in English. Do not be afraid of your English skills, as the open source community will fix your errors.</p>
<p>Of course, you are welcome to write documentation in other languages; just name them appropriately (e.g.&#160;<code>README.ja.md</code>).</p>
<h2><a class="anchor" id="autotoc_md23844"></a>
4.2. Include input and output examples</h2>
<p>The plugin's <code>README.md</code> must contain example input and output CSS. A clear example is the best way to describe how your plugin works.</p>
<p>The first section of the <code>README.md</code> is a good place to put examples. See <a href="https://github.com/iamvdo/postcss-opacity">postcss-opacity</a> for an example.</p>
<p>Of course, this guideline does not apply if your plugin does not transform the CSS.</p>
<h2><a class="anchor" id="autotoc_md23845"></a>
4.3. Maintain a changelog</h2>
<p>PostCSS plugins must describe the changes of all their releases in a separate file, such as <code>CHANGELOG.md</code>, <code>History.md</code>, or&#160;<a href="https://help.github.com/articles/creating-releases/">GitHub Releases</a>. Visit <a href="http://keepachangelog.com/">Keep A Changelog</a> for more information about how to write one of these.</p>
<p>Of course, you should be using <a href="http://semver.org/">SemVer</a>.</p>
<h2><a class="anchor" id="autotoc_md23846"></a>
4.4. Include &lt;tt&gt;postcss-plugin&lt;/tt&gt; keyword in &lt;tt&gt;package.json&lt;/tt&gt;</h2>
<p>PostCSS plugins written for npm must have the <code>postcss-plugin</code> keyword in their <code>package.json</code>. This special keyword will&#160;be useful for feedback about the PostCSS ecosystem.</p>
<p>For packages not published to npm, this is not mandatory, but is recommended if the package format can contain keywords. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
