<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: immediate &lt;a href=&quot;https://travis-ci.org/calvinmetcalf/immediate&quot;&gt;&lt;img src=&quot;https://travis-ci.org/calvinmetcalf/immediate.svg?branch=master&quot; alt=&quot;Build Status&quot;/&gt;&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_immediate__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">immediate <a href="https://travis-ci.org/calvinmetcalf/immediate"><img src="https://travis-ci.org/calvinmetcalf/immediate.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">npm install immediate --save</div>
</div><!-- fragment --><p>then</p>
<div class="fragment"><div class="line">var immediate = require(&quot;immediate&quot;);</div>
<div class="line"> </div>
<div class="line">immediate(function () {</div>
<div class="line">  // this will run soon</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">immediate(function (arg1, arg2) {</div>
<div class="line">  // get your args like in iojs</div>
<div class="line">}, thing1, thing2);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11910"></a>
Introduction</h1>
<p><b>immediate</b> is a microtask library, decended from <a href="https://github.com/NobleJS/setImmediate">NobleJS's setImmediate</a>, but including ideas from <a href="https://github.com/cujojs/when">Cujo's When</a> and <a href="https://github.com/tildeio/rsvp.js">RSVP</a>.</p>
<p>immediate takes the tricks from setImmedate and RSVP and combines them with the schedualer inspired (vaugly) by whens.</p>
<p>Note versions 2.6.5 and earlier were strictly speaking a 'macrotask' library not a microtask one, <a href="https://github.com/YuzuJS/setImmediate#macrotasks-and-microtasks">see this for the difference</a>, if you need a macrotask library, <a href="https://github.com/calvinmetcalf/macrotask">I got you covered</a>.</p>
<p>Several new features were added in versions 3.1.0 and 3.2.0 to maintain parity with process.nextTick, but the 3.0.x series is still being kept up to date if you just need the small barebones version.</p>
<h1><a class="anchor" id="autotoc_md11911"></a>
The Tricks</h1>
<h2><a class="anchor" id="autotoc_md11912"></a>
&lt;tt&gt;process.nextTick&lt;/tt&gt;</h2>
<p>Note that we check for <em>actual</em> Node.js environments, not emulated ones like those produced by browserify or similar.</p>
<h2><a class="anchor" id="autotoc_md11913"></a>
&lt;tt&gt;MutationObserver&lt;/tt&gt;</h2>
<p>This is what <a href="https://github.com/tildeio/rsvp.js">RSVP</a> uses, it's very fast, details on <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">MDN</a>.</p>
<h2><a class="anchor" id="autotoc_md11914"></a>
&lt;tt&gt;MessageChannel&lt;/tt&gt;</h2>
<p>Unfortunately, <code>postMessage</code> has completely different semantics inside web workers, and so cannot be used there. So we turn to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/web-messaging.html#channel-messaging"><code>MessageChannel</code></a>, which has worse browser support, but does work inside a web worker.</p>
<h2><a class="anchor" id="autotoc_md11915"></a>
&lt;tt&gt;&lt;script&gt; onreadystatechange&lt;/tt&gt;</h2>
<p>For our last trick, we pull something out to make things fast in Internet Explorer versions 6 through 8: namely, creating a <code>&lt;script&gt;</code> element and firing our calls in its <code>onreadystatechange</code> event. This does execute in a future turn of the event loop, and is also faster than <code>setTimeout(â€¦, 0)</code>, so hey, why not?</p>
<h1><a class="anchor" id="autotoc_md11916"></a>
Tricks we don't use</h1>
<h2><a class="anchor" id="autotoc_md11917"></a>
&lt;tt&gt;setImmediate&lt;/tt&gt;</h2>
<p>We avoid this process.nextTick in node is better suited to our needs and in Internet Explorer 10 there is a broken version of setImmediate we avoid using this.</p>
<p>In Node.js, do</p>
<div class="fragment"><div class="line">npm install immediate</div>
</div><!-- fragment --><p>then</p>
<div class="fragment"><div class="line">var immediate = require(&quot;immediate&quot;);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11918"></a>
Reference and Reading</h1>
<ul>
<li><a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html">Efficient Script Yielding W3C Editor's Draft</a></li>
<li><a href="http://lists.w3.org/Archives/Public/public-web-perf/2011Jun/0100.html">W3C mailing list post introducing the specification</a></li>
<li><a href="http://ie.microsoft.com/testdrive/Performance/setImmediateSorting/Default.html">IE Test Drive demo</a></li>
<li><a href="http://www.nczonline.net/blog/2011/09/19/script-yielding-with-setimmediate/">Introductory blog post by Nicholas C. Zakas</a></li>
<li>I wrote a couple blog pots on this, <a href="http://calvinmetcalf.com/post/61672207151/setimmediate-etc">part 1</a> and <a href="http://calvinmetcalf.com/post/61761231881/javascript-schedulers">part 2</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
