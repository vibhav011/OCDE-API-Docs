<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: PostCSS Runner Guidelines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_resolve-url-loader_node_modules_postcss_docs_guidelines_runner.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PostCSS Runner Guidelines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A PostCSS runner is a tool that processes CSS through a user-defined list of plugins; for example, <a href="https://github.com/postcss/postcss-cli"><code>postcss-cli</code></a> or&#160;<a href="https://github.com/w0rm/gulp-postcss"><code>gulp‑postcss</code></a>. These rules are mandatory for any such runners.</p>
<p>For single-plugin tools, like <a href="https://github.com/sindresorhus/gulp-autoprefixer"><code>gulp-autoprefixer</code></a>, these rules are not mandatory but are highly recommended.</p>
<p>See also <a href="http://blog.clojurewerkz.org/blog/2013/04/20/how-to-make-your-open-source-project-really-awesome/">ClojureWerkz’s recommendations</a> for open source projects.</p>
<h1><a class="anchor" id="autotoc_md23848"></a>
1. API</h1>
<h2><a class="anchor" id="autotoc_md23849"></a>
1.1. Accept functions in plugin parameters</h2>
<p>If your runner uses a config file, it must be written in JavaScript, so that it can support plugins which accept a function, such as [<code>postcss-assets</code>]:</p>
<div class="fragment"><div class="line">module.exports = [</div>
<div class="line">  require(&#39;postcss-assets&#39;)({</div>
<div class="line">    cachebuster: function (file) {</div>
<div class="line">      return fs.statSync(file).mtime.getTime().toString(16)</div>
<div class="line">    }</div>
<div class="line">  })</div>
<div class="line">]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23850"></a>
2. Processing</h1>
<h2><a class="anchor" id="autotoc_md23851"></a>
2.1. Set &lt;tt&gt;from&lt;/tt&gt; and &lt;tt&gt;to&lt;/tt&gt; processing options</h2>
<p>To ensure that PostCSS generates source maps and displays better syntax errors, runners must specify the <code>from</code> and <code>to</code> options. If your runner does not handle writing to disk (for example, a gulp transform), you should set both options to point to&#160;the same file:</p>
<div class="fragment"><div class="line">processor.process({ from: file.path, to: file.path })</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23852"></a>
2.2. Use only the asynchronous API</h2>
<p>PostCSS runners must use only the asynchronous API. The synchronous API is provided only for debugging, is slower, and can’t work with asynchronous plugins.</p>
<div class="fragment"><div class="line">processor.process(opts).then(result =&gt; {</div>
<div class="line">  // processing is finished</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23853"></a>
2.3. Use only the public PostCSS API</h2>
<p>PostCSS runners must not rely on undocumented properties or methods, which may be subject to change in any minor release. The public API is described in <a href="http://api.postcss.org/">API docs</a>.</p>
<h1><a class="anchor" id="autotoc_md23854"></a>
3. Output</h1>
<h2><a class="anchor" id="autotoc_md23855"></a>
3.1. Don’t show JS stack for &lt;tt&gt;CssSyntaxError&lt;/tt&gt;</h2>
<p>PostCSS runners must not show a stack trace for CSS syntax errors, as the runner can be used by developers who&#160;are&#160;not familiar with JavaScript. Instead, handle such errors gracefully:</p>
<div class="fragment"><div class="line">processor.process(opts).catch(error =&gt; {</div>
<div class="line">  if (error.name === &#39;CssSyntaxError&#39;) {</div>
<div class="line">    process.stderr.write(error.message + error.showSourceCode())</div>
<div class="line">  } else {</div>
<div class="line">    throw error</div>
<div class="line">  }</div>
<div class="line">})</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23856"></a>
3.2. Display &lt;tt&gt;result.warnings()&lt;/tt&gt;</h2>
<p>PostCSS runners must output warnings from <code>result.warnings()</code>:</p>
<div class="fragment"><div class="line">result.warnings().forEach(warn =&gt; {</div>
<div class="line">  process.stderr.write(warn.toString())</div>
<div class="line">})</div>
</div><!-- fragment --><p>See also <a href="https://github.com/davidtheclark/postcss-log-warnings">postcss-log-warnings</a> and <a href="https://github.com/postcss/postcss-messages">postcss-messages</a> plugins.</p>
<h2><a class="anchor" id="autotoc_md23857"></a>
3.3. Allow the user to write source maps to different files</h2>
<p>PostCSS by default will inline source maps in the generated file; however, PostCSS runners must provide an option to&#160;save the source map in a different file:</p>
<div class="fragment"><div class="line">if (result.map) {</div>
<div class="line">  fs.writeFile(opts.to + &#39;.map&#39;, result.map.toString())</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23858"></a>
4. Documentation</h1>
<h2><a class="anchor" id="autotoc_md23859"></a>
4.1. Document your runner in English</h2>
<p>PostCSS runners must have their <code>README.md</code> wrote in English. Do not be afraid of your English skills, as the open source community will fix your errors.</p>
<p>Of course, you are welcome to write documentation in other languages; just name them appropriately (e.g.&#160;<code>README.ja.md</code>).</p>
<h2><a class="anchor" id="autotoc_md23860"></a>
4.2. Maintain a changelog</h2>
<p>PostCSS runners must describe changes of all releases in a separate file, such as <code>ChangeLog.md</code>, <code>History.md</code>, or&#160;with&#160;<a href="https://help.github.com/articles/creating-releases/">GitHub Releases</a>. Visit <a href="http://keepachangelog.com/">Keep A Changelog</a> for more information on how to write one of these.</p>
<p>Of course, you should use <a href="http://semver.org/">SemVer</a>.</p>
<h2><a class="anchor" id="autotoc_md23861"></a>
4.3. &lt;tt&gt;postcss-runner&lt;/tt&gt; keyword in &lt;tt&gt;package.json&lt;/tt&gt;</h2>
<p>PostCSS runners written for npm must have the <code>postcss-runner</code> keyword in their <code>package.json</code>. This special keyword will&#160;be useful for feedback about the PostCSS ecosystem.</p>
<p>For packages not published to npm, this is not mandatory, but recommended if the package format is allowed to contain keywords. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
