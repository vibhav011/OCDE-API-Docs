<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: http-proxy-middleware</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_http-proxy-middleware__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">http-proxy-middleware </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/chimurai/http-proxy-middleware"><img src="https://img.shields.io/travis/chimurai/http-proxy-middleware/master.svg?style=flat-square" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a href="https://coveralls.io/r/chimurai/http-proxy-middleware"><img src="https://img.shields.io/coveralls/chimurai/http-proxy-middleware.svg?style=flat-square" alt="Coveralls" style="pointer-events: none;" class="inline"/></a> <a href="https://david-dm.org/chimurai/http-proxy-middleware#info=dependencies"><img src="https://img.shields.io/david/chimurai/http-proxy-middleware.svg?style=flat-square" alt="dependency Status" style="pointer-events: none;" class="inline"/></a> <a href="https://snyk.io/test/npm/http-proxy-middleware"><img src="https://snyk.io/test/npm/http-proxy-middleware/badge.svg" alt="dependency Status" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/prettier/prettier"><img src="https://img.shields.io/badge/code_style-prettier-ff69b4.svg?style=flat-square" alt="code style: prettier" style="pointer-events: none;" class="inline"/></a></p>
<p>Node.js proxying made simple. Configure proxy middleware with ease for <a href="https://github.com/senchalabs/connect">connect</a>, <a href="https://github.com/strongloop/express">express</a>, <a href="https://github.com/BrowserSync/browser-sync">browser-sync</a> and <a href="#compatible-servers">many more</a>.</p>
<p>Powered by the popular Nodejitsu <a href="https://github.com/nodejitsu/node-http-proxy"><code>http-proxy</code></a>. <a href="https://github.com/nodejitsu/node-http-proxy"><img src="https://img.shields.io/github/stars/nodejitsu/node-http-proxy.svg?style=social&amp;label=Star" alt="GitHub stars" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md11626"></a>
TL;DR</h1>
<p>Proxy <code>/api</code> requests to <code><a href="http://www.example.org">http://www.example.org</a></code></p>
<div class="fragment"><div class="line">var express = require(&#39;express&#39;)</div>
<div class="line">var proxy = require(&#39;http-proxy-middleware&#39;)</div>
<div class="line"> </div>
<div class="line">var app = express()</div>
<div class="line"> </div>
<div class="line">app.use(&#39;/api&#39;, proxy({ target: &#39;http://www.example.org&#39;, changeOrigin: true }))</div>
<div class="line">app.listen(3000)</div>
<div class="line"> </div>
<div class="line">// http://localhost:3000/api/foo/bar -&gt; http://www.example.org/api/foo/bar</div>
</div><!-- fragment --><p><em>All</em> <code>http-proxy</code> <a href="https://github.com/nodejitsu/node-http-proxy#options">options</a> can be used, along with some extra <code>http-proxy-middleware</code> <a href="#options">options</a>.</p>
<p>:bulb: <b>Tip:</b> Set the option <code>changeOrigin</code> to <code>true</code> for <a href="http://en.wikipedia.org/wiki/Virtual_hosting#Name-based">name-based virtual hosted sites</a>.</p>
<h1><a class="anchor" id="autotoc_md11627"></a>
Table of Contents</h1>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#core-concept">Core concept</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#context-matching">Context matching</a></li>
<li><a href="#options">Options</a><ul>
<li><a href="#http-proxy-middleware-options">http-proxy-middleware options</a></li>
<li><a href="#http-proxy-events">http-proxy events</a></li>
<li><a href="#http-proxy-options">http-proxy options</a></li>
</ul>
</li>
<li><a href="#shorthand">Shorthand</a><ul>
<li><a href="#appusepath-proxy">app.use(path, proxy)</a></li>
</ul>
</li>
<li><a href="#websocket">WebSocket</a><ul>
<li><a href="#external-websocket-upgrade">External WebSocket upgrade</a></li>
</ul>
</li>
<li><a href="#working-examples">Working examples</a></li>
<li><a href="#recipes">Recipes</a></li>
<li><a href="#compatible-servers">Compatible servers</a></li>
<li><a href="#tests">Tests</a></li>
<li><a href="#changelog">Changelog</a></li>
<li><a href="#license">License</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md11628"></a>
Install</h1>
<div class="fragment"><div class="line">$ npm install --save-dev http-proxy-middleware</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11629"></a>
Core concept</h1>
<p>Proxy middleware configuration.</p>
<h3><a class="anchor" id="autotoc_md11630"></a>
proxy([context,] config)</h3>
<div class="fragment"><div class="line">var proxy = require(&#39;http-proxy-middleware&#39;)</div>
<div class="line"> </div>
<div class="line">var apiProxy = proxy(&#39;/api&#39;, { target: &#39;http://www.example.org&#39; })</div>
<div class="line">//                   \____/   \_____________________________/</div>
<div class="line">//                     |                    |</div>
<div class="line">//                   context             options</div>
<div class="line"> </div>
<div class="line">// &#39;apiProxy&#39; is now ready to be used as middleware in a server.</div>
</div><!-- fragment --><ul>
<li><b>context</b>: Determine which requests should be proxied to the target host. (more on <a href="#context-matching">context matching</a>)</li>
<li><b>options.target</b>: target host to proxy to. _(protocol + host)_</li>
</ul>
<p>(full list of <a href="#options"><code>http-proxy-middleware</code> configuration options</a>)</p>
<h3><a class="anchor" id="autotoc_md11631"></a>
proxy(uri [, config])</h3>
<div class="fragment"><div class="line">// shorthand syntax for the example above:</div>
<div class="line">var apiProxy = proxy(&#39;http://www.example.org/api&#39;)</div>
</div><!-- fragment --><p>More about the <a href="#shorthand">shorthand configuration</a>.</p>
<h1><a class="anchor" id="autotoc_md11632"></a>
Example</h1>
<p>An example with <code>express</code> server.</p>
<div class="fragment"><div class="line">// include dependencies</div>
<div class="line">var express = require(&#39;express&#39;)</div>
<div class="line">var proxy = require(&#39;http-proxy-middleware&#39;)</div>
<div class="line"> </div>
<div class="line">// proxy middleware options</div>
<div class="line">var options = {</div>
<div class="line">  target: &#39;http://www.example.org&#39;, // target host</div>
<div class="line">  changeOrigin: true, // needed for virtual hosted sites</div>
<div class="line">  ws: true, // proxy websockets</div>
<div class="line">  pathRewrite: {</div>
<div class="line">    &#39;^/api/old-path&#39;: &#39;/api/new-path&#39;, // rewrite path</div>
<div class="line">    &#39;^/api/remove/path&#39;: &#39;/path&#39; // remove base path</div>
<div class="line">  },</div>
<div class="line">  router: {</div>
<div class="line">    // when request.headers.host == &#39;dev.localhost:3000&#39;,</div>
<div class="line">    // override target &#39;http://www.example.org&#39; to &#39;http://localhost:8000&#39;</div>
<div class="line">    &#39;dev.localhost:3000&#39;: &#39;http://localhost:8000&#39;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// create the proxy (without context)</div>
<div class="line">var exampleProxy = proxy(options)</div>
<div class="line"> </div>
<div class="line">// mount `exampleProxy` in web server</div>
<div class="line">var app = express()</div>
<div class="line">app.use(&#39;/api&#39;, exampleProxy)</div>
<div class="line">app.listen(3000)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11633"></a>
Context matching</h1>
<p>Providing an alternative way to decide which requests should be proxied; In case you are not able to use the server's <a href="http://expressjs.com/en/4x/api.html#app.use"><code>path</code> parameter</a> to mount the proxy or when you need more flexibility.</p>
<p><a href="https://tools.ietf.org/html/rfc3986#section-3.3">RFC 3986 <code>path</code></a> is used for context matching.</p>
<div class="fragment"><div class="line">  foo://example.com:8042/over/there?name=ferret#nose</div>
<div class="line">  \_/   \______________/\_________/ \_________/ \__/</div>
<div class="line">   |           |            |            |        |</div>
<div class="line">scheme     authority       path        query   fragment</div>
</div><!-- fragment --><ul>
<li><b>path matching</b><ul>
<li><code>proxy({...})</code> - matches any path, all requests will be proxied.</li>
<li>&lsquo;proxy(&rsquo;/', {...})<code>- matches any path, all requests will be proxied. -</code>proxy('/api', {...})<code>- matches paths starting with</code>/api`</li>
</ul>
</li>
<li><b>multiple path matching</b><ul>
<li>&lsquo;proxy([&rsquo;/api', '/ajax', '/someotherpath'], {...})`</li>
</ul>
</li>
<li><p class="startli"><b>wildcard path matching</b></p>
<p class="startli">For fine-grained control you can use wildcard matching. Glob pattern matching is done by <em>micromatch</em>. Visit <a href="https://www.npmjs.com/package/micromatch">micromatch</a> or <a href="https://www.npmjs.com/package/glob">glob</a> for more globbing examples.</p><ul>
<li>&lsquo;proxy(&rsquo;**', {...})<code>matches any path, all requests will be proxied. -</code>proxy('**/*.html', {...})<code>matches any path which ends with</code>.html<code> -</code>proxy('/*.html', {...})<code>matches paths directly under path-absolute -</code>proxy('/api/**/*.html', {...})<code>matches requests ending with</code>.html<code>in the path of</code>/api<code> -</code>proxy(['/api/**', '/ajax/**'], {...})<code>combine multiple patterns -</code>proxy(['/api/**', '!**/bad.json'], {...})` exclusion</li>
</ul>
<p class="startli"><b>Note</b>: In multiple path matching, you cannot use string paths and wildcard paths together.</p>
</li>
<li><p class="startli"><b>custom matching</b></p>
<p class="startli">For full control you can provide a custom function to determine which requests should be proxied or not.</p>
</li>
</ul>
<div class="fragment"><div class="line">/**</div>
<div class="line"> * @return {Boolean}</div>
<div class="line"> */</div>
<div class="line">var filter = function(pathname, req) {</div>
<div class="line">  return pathname.match(&#39;^/api&#39;) &amp;&amp; req.method === &#39;GET&#39;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">var apiProxy = proxy(filter, { target: &#39;http://www.example.org&#39; })</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11634"></a>
Options</h1>
<h2><a class="anchor" id="autotoc_md11635"></a>
http-proxy-middleware options</h2>
<ul>
<li><b>option.pathRewrite</b>: object/function, rewrite target's url path. Object-keys will be used as <em>RegExp</em> to match paths.</li>
</ul>
<div class="fragment"><div class="line">// rewrite path</div>
<div class="line">pathRewrite: {&#39;^/old/api&#39; : &#39;/new/api&#39;}</div>
<div class="line"> </div>
<div class="line">// remove path</div>
<div class="line">pathRewrite: {&#39;^/remove/api&#39; : &#39;&#39;}</div>
<div class="line"> </div>
<div class="line">// add base path</div>
<div class="line">pathRewrite: {&#39;^/&#39; : &#39;/basepath/&#39;}</div>
<div class="line"> </div>
<div class="line">// custom rewriting</div>
<div class="line">pathRewrite: function (path, req) { return path.replace(&#39;/api&#39;, &#39;/base/api&#39;) }</div>
</div><!-- fragment --><ul>
<li><b>option.router</b>: object/function, re-target <code>option.target</code> for specific requests.</li>
</ul>
<div class="fragment"><div class="line">// Use `host` and/or `path` to match requests. First match will be used.</div>
<div class="line">// The order of the configuration matters.</div>
<div class="line">router: {</div>
<div class="line">    &#39;integration.localhost:3000&#39; : &#39;http://localhost:8001&#39;,  // host only</div>
<div class="line">    &#39;staging.localhost:3000&#39;     : &#39;http://localhost:8002&#39;,  // host only</div>
<div class="line">    &#39;localhost:3000/api&#39;         : &#39;http://localhost:8003&#39;,  // host + path</div>
<div class="line">    &#39;/rest&#39;                      : &#39;http://localhost:8004&#39;   // path only</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Custom router function</div>
<div class="line">router: function(req) {</div>
<div class="line">    return &#39;http://localhost:8004&#39;;</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.logLevel</b>: string, ['debug', 'info', 'warn', 'error', 'silent']. Default: &lsquo;'info&rsquo;`</li>
<li><b>option.logProvider</b>: function, modify or replace log provider. Default: <code>console</code>.</li>
</ul>
<div class="fragment"><div class="line">// simple replace</div>
<div class="line">function logProvider(provider) {</div>
<div class="line">  // replace the default console log provider.</div>
<div class="line">  return require(&#39;winston&#39;)</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">// verbose replacement</div>
<div class="line">function logProvider(provider) {</div>
<div class="line">  var logger = new (require(&#39;winston&#39;)).Logger()</div>
<div class="line"> </div>
<div class="line">  var myCustomProvider = {</div>
<div class="line">    log: logger.log,</div>
<div class="line">    debug: logger.debug,</div>
<div class="line">    info: logger.info,</div>
<div class="line">    warn: logger.warn,</div>
<div class="line">    error: logger.error</div>
<div class="line">  }</div>
<div class="line">  return myCustomProvider</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>(DEPRECATED) <b>option.proxyHost</b>: Use <code>option.changeOrigin = true</code> instead.</li>
<li>(DEPRECATED) <b>option.proxyTable</b>: Use <code>option.router</code> instead.</li>
</ul>
<h2><a class="anchor" id="autotoc_md11636"></a>
http-proxy events</h2>
<p>Subscribe to <a href="https://github.com/nodejitsu/node-http-proxy#listening-for-proxy-events">http-proxy events</a>:</p>
<ul>
<li><b>option.onError</b>: function, subscribe to http-proxy's <code>error</code> event for custom error handling.</li>
</ul>
<div class="fragment"><div class="line">function onError(err, req, res) {</div>
<div class="line">  res.writeHead(500, {</div>
<div class="line">    &#39;Content-Type&#39;: &#39;text/plain&#39;</div>
<div class="line">  })</div>
<div class="line">  res.end(</div>
<div class="line">    &#39;Something went wrong. And we are reporting a custom error message.&#39;</div>
<div class="line">  )</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.onProxyRes</b>: function, subscribe to http-proxy's <code>proxyRes</code> event.</li>
</ul>
<div class="fragment"><div class="line">function onProxyRes(proxyRes, req, res) {</div>
<div class="line">  proxyRes.headers[&#39;x-added&#39;] = &#39;foobar&#39; // add new header to response</div>
<div class="line">  delete proxyRes.headers[&#39;x-removed&#39;] // remove header from response</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.onProxyReq</b>: function, subscribe to http-proxy's <code>proxyReq</code> event.</li>
</ul>
<div class="fragment"><div class="line">function onProxyReq(proxyReq, req, res) {</div>
<div class="line">  // add custom header to request</div>
<div class="line">  proxyReq.setHeader(&#39;x-added&#39;, &#39;foobar&#39;)</div>
<div class="line">  // or log the req</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.onProxyReqWs</b>: function, subscribe to http-proxy's <code>proxyReqWs</code> event.</li>
</ul>
<div class="fragment"><div class="line">function onProxyReqWs(proxyReq, req, socket, options, head) {</div>
<div class="line">  // add custom header</div>
<div class="line">  proxyReq.setHeader(&#39;X-Special-Proxy-Header&#39;, &#39;foobar&#39;)</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.onOpen</b>: function, subscribe to http-proxy's <code>open</code> event.</li>
</ul>
<div class="fragment"><div class="line">function onOpen(proxySocket) {</div>
<div class="line">  // listen for messages coming FROM the target here</div>
<div class="line">  proxySocket.on(&#39;data&#39;, hybiParseAndLogMessage)</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li><b>option.onClose</b>: function, subscribe to http-proxy's <code>close</code> event. <div class="fragment"><div class="line">function onClose(res, socket, head) {</div>
<div class="line">  // view disconnected websocket connections</div>
<div class="line">  console.log(&#39;Client disconnected&#39;)</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="autotoc_md11637"></a>
http-proxy options</h2>
<p>The following options are provided by the underlying <a href="https://github.com/nodejitsu/node-http-proxy#options">http-proxy</a> library.</p>
<ul>
<li><b>option.target</b>: url string to be parsed with the url module</li>
<li><b>option.forward</b>: url string to be parsed with the url module</li>
<li><b>option.agent</b>: object to be passed to http(s).request (see Node's <a href="http://nodejs.org/api/https.html#https_class_https_agent">https agent</a> and <a href="http://nodejs.org/api/http.html#http_class_http_agent">http agent</a> objects)</li>
<li><b>option.ssl</b>: object to be passed to https.createServer()</li>
<li><b>option.ws</b>: true/false: if you want to proxy websockets</li>
<li><b>option.xfwd</b>: true/false, adds x-forward headers</li>
<li><b>option.secure</b>: true/false, if you want to verify the SSL Certs</li>
<li><b>option.toProxy</b>: true/false, passes the absolute URL as the <code>path</code> (useful for proxying to proxies)</li>
<li><b>option.prependPath</b>: true/false, Default: true - specify whether you want to prepend the target's path to the proxy path</li>
<li><b>option.ignorePath</b>: true/false, Default: false - specify whether you want to ignore the proxy path of the incoming request (note: you will have to append / manually if required).</li>
<li><b>option.localAddress</b> : Local interface string to bind for outgoing connections</li>
<li><b>option.changeOrigin</b>: true/false, Default: false - changes the origin of the host header to the target URL</li>
<li><b>option.preserveHeaderKeyCase</b>: true/false, Default: false - specify whether you want to keep letter case of response header key</li>
<li><b>option.auth</b> : Basic authentication i.e. 'user:password' to compute an Authorization header.</li>
<li><b>option.hostRewrite</b>: rewrites the location hostname on (301/302/307/308) redirects.</li>
<li><b>option.autoRewrite</b>: rewrites the location host/port on (301/302/307/308) redirects based on requested host/port. Default: false.</li>
<li><b>option.protocolRewrite</b>: rewrites the location protocol on (301/302/307/308) redirects to 'http' or 'https'. Default: null.</li>
<li><b>option.cookieDomainRewrite</b>: rewrites domain of <code>set-cookie</code> headers. Possible values:<ul>
<li><code>false</code> (default): disable cookie rewriting</li>
<li>String: new domain, for example <code>cookieDomainRewrite: "new.domain"</code>. To remove the domain, use <code>cookieDomainRewrite: ""</code>.</li>
<li>Object: mapping of domains to new domains, use <code>"*"</code> to match all domains. <br  />
 For example keep one domain unchanged, rewrite one domain and remove other domains: ``` cookieDomainRewrite: { "unchanged.domain": "unchanged.domain", "old.domain": "new.domain", "*": "" } ``<code></code></li>
</ul>
</li>
<li><code>**option.cookiePathRewrite**: rewrites path of</code>set-cookie<code>headers. Possible values: -</code>false&lt;tt&gt;(default): disable cookie rewriting<ul>
<li>String: new path, for examplecookiePathRewrite: "/newPath/"<code>. To remove the path, use</code>cookiePathRewrite: ""<code>. To set path to root use</code>cookiePathRewrite: "/"<code>.</code></li>
<li><code>Object: mapping of paths to new paths, use</code>"*"` to match all paths. For example, to keep one path unchanged, rewrite one path and remove other paths: ``` cookiePathRewrite: { "/unchanged.path/": "/unchanged.path/", "/old.path/": "/new.path/", "*": "" } ``<code></code></li>
</ul>
</li>
<li><code>**option.headers**: object, adds [request headers](<a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields">https://en.wikipedia.org/wiki/List_of_HTTP_header_fields</a>#Request_fields). (Example:</code>{host:'www.example.org'}`)</li>
<li><b>option.proxyTimeout</b>: timeout (in millis) when proxy receives no response from target</li>
<li><b>option.timeout</b>: timeout (in millis) for incoming requests</li>
<li><b>option.followRedirects</b>: true/false, Default: false - specify whether you want to follow redirects</li>
<li><b>option.selfHandleResponse</b> true/false, if set to true, none of the webOutgoing passes are called and it's your responsibility to appropriately return the response by listening and acting on the <code>proxyRes</code> event</li>
<li><b>option.buffer</b>: stream of data to send as the request body. Maybe you have some middleware that consumes the request stream before proxying it on e.g. If you read the body of a request into a field called 'req.rawbody' you could restream this field in the buffer option:</li>
</ul>
<div class="fragment"><div class="line">&#39;use strict&#39;;</div>
<div class="line"> </div>
<div class="line">const streamify = require(&#39;stream-array&#39;);</div>
<div class="line">const HttpProxy = require(&#39;http-proxy&#39;);</div>
<div class="line">const proxy = new HttpProxy();</div>
<div class="line"> </div>
<div class="line">module.exports = (req, res, next) =&gt; {</div>
<div class="line"> </div>
<div class="line">  proxy.web(req, res, {</div>
<div class="line">    target: &#39;http://localhost:4003/&#39;,</div>
<div class="line">    buffer: streamify(req.rawBody)</div>
<div class="line">  }, next);</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11638"></a>
Shorthand</h1>
<p>Use the shorthand syntax when verbose configuration is not needed. The <code>context</code> and <code>option.target</code> will be automatically configured when shorthand is used. Options can still be used if needed.</p>
<div class="fragment"><div class="line">proxy(&#39;http://www.example.org:8000/api&#39;)</div>
<div class="line">// proxy(&#39;/api&#39;, {target: &#39;http://www.example.org:8000&#39;});</div>
<div class="line"> </div>
<div class="line">proxy(&#39;http://www.example.org:8000/api/books/*/**.json&#39;)</div>
<div class="line">// proxy(&#39;/api/books/*/**.json&#39;, {target: &#39;http://www.example.org:8000&#39;});</div>
<div class="line"> </div>
<div class="line">proxy(&#39;http://www.example.org:8000/api&#39;, { changeOrigin: true })</div>
<div class="line">// proxy(&#39;/api&#39;, {target: &#39;http://www.example.org:8000&#39;, changeOrigin: true});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11639"></a>
app.use(path, proxy)</h2>
<p>If you want to use the server's <code>app.use</code> <code>path</code> parameter to match requests; Create and mount the proxy without the http-proxy-middleware <code>context</code> parameter:</p>
<div class="fragment"><div class="line">app.use(&#39;/api&#39;, proxy({ target: &#39;http://www.example.org&#39;, changeOrigin: true }))</div>
</div><!-- fragment --><p><code>app.use</code> documentation:</p>
<ul>
<li>express: <a href="http://expressjs.com/en/4x/api.html#app.use">http://expressjs.com/en/4x/api.html#app.use</a></li>
<li>connect: <a href="https://github.com/senchalabs/connect#mount-middleware">https://github.com/senchalabs/connect#mount-middleware</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md11640"></a>
WebSocket</h1>
<div class="fragment"><div class="line">// verbose api</div>
<div class="line">proxy(&#39;/&#39;, { target: &#39;http://echo.websocket.org&#39;, ws: true })</div>
<div class="line"> </div>
<div class="line">// shorthand</div>
<div class="line">proxy(&#39;http://echo.websocket.org&#39;, { ws: true })</div>
<div class="line"> </div>
<div class="line">// shorter shorthand</div>
<div class="line">proxy(&#39;ws://echo.websocket.org&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11641"></a>
External WebSocket upgrade</h2>
<p>In the previous WebSocket examples, http-proxy-middleware relies on a initial http request in order to listen to the http <code>upgrade</code> event. If you need to proxy WebSockets without the initial http request, you can subscribe to the server's http <code>upgrade</code> event manually.</p>
<div class="fragment"><div class="line">var wsProxy = proxy(&#39;ws://echo.websocket.org&#39;, { changeOrigin: true })</div>
<div class="line"> </div>
<div class="line">var app = express()</div>
<div class="line">app.use(wsProxy)</div>
<div class="line"> </div>
<div class="line">var server = app.listen(3000)</div>
<div class="line">server.on(&#39;upgrade&#39;, wsProxy.upgrade) // &lt;-- subscribe to http &#39;upgrade&#39;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11642"></a>
Working examples</h1>
<p>View and play around with <a href="https://github.com/chimurai/http-proxy-middleware/tree/master/examples">working examples</a>.</p>
<ul>
<li>Browser-Sync (<a href="https://github.com/chimurai/http-proxy-middleware/tree/master/examples/browser-sync/index.js">example source</a>)</li>
<li>express (<a href="https://github.com/chimurai/http-proxy-middleware/tree/master/examples/express/index.js">example source</a>)</li>
<li>connect (<a href="https://github.com/chimurai/http-proxy-middleware/tree/master/examples/connect/index.js">example source</a>)</li>
<li>WebSocket (<a href="https://github.com/chimurai/http-proxy-middleware/tree/master/examples/websocket/index.js">example source</a>)</li>
</ul>
<h1><a class="anchor" id="autotoc_md11643"></a>
Recipes</h1>
<p>View the <a href="https://github.com/chimurai/http-proxy-middleware/tree/master/recipes">recipes</a> for common use cases.</p>
<h1><a class="anchor" id="autotoc_md11644"></a>
Compatible servers</h1>
<p><code>http-proxy-middleware</code> is compatible with the following servers:</p>
<ul>
<li><a href="https://www.npmjs.com/package/connect">connect</a></li>
<li><a href="https://www.npmjs.com/package/express">express</a></li>
<li><a href="https://www.npmjs.com/package/browser-sync">browser-sync</a></li>
<li><a href="https://www.npmjs.com/package/lite-server">lite-server</a></li>
<li><a href="https://www.npmjs.com/package/grunt-contrib-connect">grunt-contrib-connect</a></li>
<li><a href="https://www.npmjs.com/package/grunt-browser-sync">grunt-browser-sync</a></li>
<li><a href="https://www.npmjs.com/package/gulp-connect">gulp-connect</a></li>
<li><a href="https://www.npmjs.com/package/gulp-webserver">gulp-webserver</a></li>
</ul>
<p>Sample implementations can be found in the <a href="https://github.com/chimurai/http-proxy-middleware/tree/master/recipes/servers.md">server recipes</a>.</p>
<h1><a class="anchor" id="autotoc_md11645"></a>
Tests</h1>
<p>Run the test suite:</p>
<div class="fragment"><div class="line"># install dependencies</div>
<div class="line">$ npm install</div>
<div class="line"> </div>
<div class="line"># linting</div>
<div class="line">$ npm run lint</div>
<div class="line"> </div>
<div class="line"># unit tests</div>
<div class="line">$ npm test</div>
<div class="line"> </div>
<div class="line"># code coverage</div>
<div class="line">$ npm run cover</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11646"></a>
Changelog</h1>
<ul>
<li><a href="https://github.com/chimurai/http-proxy-middleware/blob/master/CHANGELOG.md">View changelog</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md11647"></a>
License</h1>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2015-2018 Steven Chim </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
