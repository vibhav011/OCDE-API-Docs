<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: Forge</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_node-forge__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Forge </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://nodei.co/npm/node-forge/"><img src="https://nodei.co/npm/node-forge.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="npm package" class="inline"/></a></p>
<p><a href="https://travis-ci.org/digitalbazaar/forge"><img src="https://img.shields.io/travis/digitalbazaar/forge.svg?branch=master" alt="Build status" style="pointer-events: none;" class="inline"/></a></p>
<p>A native implementation of <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> (and various other cryptographic tools) in <a href="https://en.wikipedia.org/wiki/JavaScript">JavaScript</a>.</p>
<h1><a class="anchor" id="autotoc_md17369"></a>
Introduction</h1>
<p>The Forge software is a fully native implementation of the <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> protocol in JavaScript, a set of cryptography utilities, and a set of tools for developing Web Apps that utilize many network resources.</p>
<h1><a class="anchor" id="autotoc_md17370"></a>
Performance</h1>
<p>Forge is fast. Benchmarks against other popular JavaScript cryptography libraries can be found here:</p>
<ul>
<li><a href="http://dominictarr.github.io/crypto-bench/">http://dominictarr.github.io/crypto-bench/</a></li>
<li><a href="http://cryptojs.altervista.org/test/simulate-threading-speed_test.html">http://cryptojs.altervista.org/test/simulate-threading-speed_test.html</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md17371"></a>
Documentation</h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#contributing">Contributing</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17372"></a>
API</h2>
<ul>
<li><a href="#options">Options</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17373"></a>
Transports</h2>
<ul>
<li><a href="#tls">TLS</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#ssh">SSH</a></li>
<li><a href="#xhr">XHR</a></li>
<li><a href="#socket">Sockets</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17374"></a>
Ciphers</h2>
<ul>
<li><a href="#cipher">CIPHER</a></li>
<li><a href="#aes">AES</a></li>
<li><a href="#des">DES</a></li>
<li><a href="#rc2">RC2</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17375"></a>
PKI</h2>
<ul>
<li><a href="#ed25519">ED25519</a></li>
<li><a href="#rsa">RSA</a></li>
<li><a href="#rsakem">RSA-KEM</a></li>
<li><a href="#x509">X.509</a></li>
<li><a href="#pkcs5">PKCS#5</a></li>
<li><a href="#pkcs7">PKCS#7</a></li>
<li><a href="#pkcs8">PKCS#8</a></li>
<li><a href="#pkcs10">PKCS#10</a></li>
<li><a href="#pkcs12">PKCS#12</a></li>
<li><a href="#asn">ASN.1</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17376"></a>
Message Digests</h2>
<ul>
<li><a href="#sha1">SHA1</a></li>
<li><a href="#sha256">SHA256</a></li>
<li><a href="#sha384">SHA384</a></li>
<li><a href="#sha512">SHA512</a></li>
<li><a href="#md5">MD5</a></li>
<li><a href="#hmac">HMAC</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17377"></a>
Utilities</h2>
<ul>
<li><a href="#prime">Prime</a></li>
<li><a href="#prng">PRNG</a></li>
<li><a href="#task">Tasks</a></li>
<li><a href="#util">Utilities</a></li>
<li><a href="#log">Logging</a></li>
<li><a href="#debug">Debugging</a></li>
<li><a href="#flash">Flash Networking Support</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md17378"></a>
Other</h2>
<ul>
<li><a href="#security-considerations">Security Considerations</a></li>
<li><a href="#library-background">Library Background</a></li>
<li><a href="#contact">Contact</a></li>
<li><a href="#donations">Donations</a></li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md17380"></a>
Installation</h1>
<p><b>Note</b>: Please see the <a href="#security-considerations">Security Considerations</a> section before using packaging systems and pre-built files.</p>
<p>Forge uses a <a href="https://en.wikipedia.org/wiki/CommonJS">CommonJS</a> module structure with a build process for browser bundles. The older <a href="https://github.com/digitalbazaar/forge/tree/0.6.x">0.6.x</a> branch with standalone files is available but will not be regularly updated.</p>
<h2><a class="anchor" id="autotoc_md17381"></a>
Node.js</h2>
<p>If you want to use forge with <a href="https://nodejs.org/">Node.js</a>, it is available through <code>npm</code>:</p>
<p><a href="https://npmjs.org/package/node-forge">https://npmjs.org/package/node-forge</a></p>
<p>Installation: </p><pre class="fragment">npm install node-forge
</pre><p>You can then use forge as a regular module:</p>
<div class="fragment"><div class="line">var forge = require(&#39;node-forge&#39;);</div>
</div><!-- fragment --><p>The npm package includes pre-built <code>forge.min.js</code>, <code>forge.all.min.js</code>, and <code>prime.worker.min.js</code> using the <a href="https://github.com/umdjs/umd">UMD</a> format.</p>
<h2><a class="anchor" id="autotoc_md17382"></a>
Bundle / Bower</h2>
<p>Each release is published in a separate repository as pre-built and minimized basic forge bundles using the <a href="https://github.com/umdjs/umd">UMD</a> format.</p>
<p><a href="https://github.com/digitalbazaar/forge-dist">https://github.com/digitalbazaar/forge-dist</a></p>
<p>This bundle can be used in many environments. In particular it can be installed with <a href="https://bower.io/">Bower</a>: </p><pre class="fragment">bower install forge
</pre><h2><a class="anchor" id="autotoc_md17383"></a>
jsDelivr CDN</h2>
<p>To use it via <a href="https://www.jsdelivr.com/package/npm/node-forge">jsDelivr</a> include this in your html:</p>
<div class="fragment"><div class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/node-forge@0.7.0/dist/forge.min.js&quot;&gt;&lt;/script&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17384"></a>
unpkg CDN</h2>
<p>To use it via <a href="https://unpkg.com/#/">unpkg</a> include this in your html:</p>
<div class="fragment"><div class="line">&lt;script src=&quot;https://unpkg.com/node-forge@0.7.0/dist/forge.min.js&quot;&gt;&lt;/script&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17385"></a>
Development Requirements</h2>
<p>The core JavaScript has the following requirements to build and test:</p>
<ul>
<li>Building a browser bundle:<ul>
<li>Node.js</li>
<li>npm</li>
</ul>
</li>
<li>Testing<ul>
<li>Node.js</li>
<li>npm</li>
<li>Chrome, Firefox, Safari (optional)</li>
</ul>
</li>
</ul>
<p>Some special networking features can optionally use a Flash component. See the <a class="el" href="md_frontend_node_modules_node-forge_flash__r_e_a_d_m_e.html">Flash README</a> for details.</p>
<h2><a class="anchor" id="autotoc_md17386"></a>
Building for a web browser</h2>
<p>To create single file bundles for use with browsers run the following: </p><pre class="fragment">npm install
npm run build
</pre><p>This will create single non-minimized and minimized files that can be included in the browser: </p><pre class="fragment">dist/forge.js
dist/forge.min.js
</pre><p>A bundle that adds some utilities and networking support is also available: </p><pre class="fragment">dist/forge.all.js
dist/forge.all.min.js
</pre><p>Include the file via:</p>
<div class="fragment"><div class="line">&lt;script src=&quot;YOUR_SCRIPT_PATH/forge.js&quot;&gt;&lt;/script&gt;</div>
</div><!-- fragment --><p>or </p><div class="fragment"><div class="line">&lt;script src=&quot;YOUR_SCRIPT_PATH/forge.min.js&quot;&gt;&lt;/script&gt;</div>
</div><!-- fragment --><p>The above bundles will synchronously create a global 'forge' object.</p>
<p><b>Note</b>: These bundles will not include any WebWorker scripts (eg: <code>dist/prime.worker.js</code>), so these will need to be accessible from the browser if any WebWorkers are used.</p>
<h2><a class="anchor" id="autotoc_md17387"></a>
Building a custom browser bundle</h2>
<p>The build process uses <a href="https://webpack.github.io/">webpack</a> and the <a href="./webpack.config.js">config</a> file can be modified to generate a file or files that only contain the parts of forge you need.</p>
<p><a href="http://browserify.org/">Browserify</a> override support is also present in <code>package.json</code>.</p>
<h1><a class="anchor" id="autotoc_md17388"></a>
Testing</h1>
<h2><a class="anchor" id="autotoc_md17389"></a>
Prepare to run tests</h2>
<pre class="fragment">npm install
</pre><h2><a class="anchor" id="autotoc_md17390"></a>
Running automated tests with Node.js</h2>
<p>Forge natively runs in a <a href="https://nodejs.org/">Node.js</a> environment: </p><pre class="fragment">npm test
</pre><h2><a class="anchor" id="autotoc_md17391"></a>
Running automated tests with Headless Chrome</h2>
<p>Automated testing is done via <a href="https://karma-runner.github.io/">Karma</a>. By default it will run the tests with Headless Chrome. </p><pre class="fragment">npm run test-karma
</pre><p>Is 'mocha' reporter output too verbose? Other reporters are available. Try 'dots', 'progress', or 'tap'. </p><pre class="fragment">npm run test-karma -- --reporters progress
</pre><p>By default <a href="https://webpack.github.io/">webpack</a> is used. <a href="http://browserify.org/">Browserify</a> can also be used. </p><pre class="fragment">BUNDLER=browserify npm run test-karma
</pre><h2><a class="anchor" id="autotoc_md17392"></a>
Running automated tests with one or more browsers</h2>
<p>You can also specify one or more browsers to use. </p><pre class="fragment">npm run test-karma -- --browsers Chrome,Firefox,Safari,ChromeHeadless
</pre><p>The reporter option and <code>BUNDLER</code> environment variable can also be used.</p>
<h2><a class="anchor" id="autotoc_md17393"></a>
Running manual tests in a browser</h2>
<p>Testing in a browser uses <a href="https://webpack.github.io/">webpack</a> to combine forge and all tests and then loading the result in a browser. A simple web server is provided that will output the HTTP or HTTPS URLs to load. It also will start a simple Flash Policy Server. Unit tests and older legacy tests are provided. Custom ports can be used by running <code>node tests/server.js</code> manually.</p>
<p>To run the unit tests in a browser a special forge build is required: </p><pre class="fragment">npm run test-build
</pre><p>To run legacy browser based tests the main forge build is required: </p><pre class="fragment">npm run build
</pre><p>The tests are run with a custom server that prints out the URLs to use: </p><pre class="fragment">npm run test-server
</pre><h2><a class="anchor" id="autotoc_md17394"></a>
Running other tests</h2>
<p>There are some other random tests and benchmarks available in the tests directory.</p>
<h2><a class="anchor" id="autotoc_md17395"></a>
Coverage testing</h2>
<p>To perform coverage testing of the unit tests, run the following. The results will be put in the <code>coverage/</code> directory. Note that coverage testing can slow down some tests considerably. </p><pre class="fragment">npm install
npm run coverage
</pre><h1><a class="anchor" id="autotoc_md17396"></a>
Contributing</h1>
<p>Any contributions (eg: PRs) that are accepted will be brought under the same license used by the rest of the Forge project. This license allows Forge to be used under the terms of either the BSD License or the GNU General Public License (GPL) Version 2.</p>
<p>See: <a href="https://github.com/digitalbazaar/forge/blob/cbebca3780658703d925b61b2caffb1d263a6c1d/LICENSE">LICENSE</a></p>
<p>If a contribution contains 3rd party source code with its own license, it may retain it, so long as that license is compatible with the Forge license.</p>
<h1><a class="anchor" id="autotoc_md17397"></a>
API</h1>
<p><a class="anchor" id="options"></a></p>
<h2><a class="anchor" id="autotoc_md17398"></a>
Options</h2>
<p>If at any time you wish to disable the use of native code, where available, for particular forge features like its secure random number generator, you may set the <code>forge.options.usePureJavaScript</code> flag to <code>true</code>. It is not recommended that you set this flag as native code is typically more performant and may have stronger security properties. It may be useful to set this flag to test certain features that you plan to run in environments that are different from your testing environment.</p>
<p>To disable native code when including forge in the browser:</p>
<div class="fragment"><div class="line">// run this *after* including the forge script</div>
<div class="line">forge.options.usePureJavaScript = true;</div>
</div><!-- fragment --><p>To disable native code when using Node.js:</p>
<div class="fragment"><div class="line">var forge = require(&#39;node-forge&#39;);</div>
<div class="line">forge.options.usePureJavaScript = true;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17399"></a>
Transports</h1>
<p><a class="anchor" id="tls"></a></p>
<h2><a class="anchor" id="autotoc_md17400"></a>
TLS</h2>
<p>Provides a native javascript client and server-side <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> implementation.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// create TLS client</div>
<div class="line">var client = forge.tls.createConnection({</div>
<div class="line">  server: false,</div>
<div class="line">  caStore: /* Array of PEM-formatted certs or a CA store object */,</div>
<div class="line">  sessionCache: {},</div>
<div class="line">  // supported cipher suites in order of preference</div>
<div class="line">  cipherSuites: [</div>
<div class="line">    forge.tls.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA,</div>
<div class="line">    forge.tls.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA],</div>
<div class="line">  virtualHost: &#39;example.com&#39;,</div>
<div class="line">  verify: function(connection, verified, depth, certs) {</div>
<div class="line">    if(depth === 0) {</div>
<div class="line">      var cn = certs[0].subject.getField(&#39;CN&#39;).value;</div>
<div class="line">      if(cn !== &#39;example.com&#39;) {</div>
<div class="line">        verified = {</div>
<div class="line">          alert: forge.tls.Alert.Description.bad_certificate,</div>
<div class="line">          message: &#39;Certificate common name does not match hostname.&#39;</div>
<div class="line">        };</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    return verified;</div>
<div class="line">  },</div>
<div class="line">  connected: function(connection) {</div>
<div class="line">    console.log(&#39;connected&#39;);</div>
<div class="line">    // send message to server</div>
<div class="line">    connection.prepare(forge.util.encodeUtf8(&#39;Hi server!&#39;));</div>
<div class="line">    /* NOTE: experimental, start heartbeat retransmission timer</div>
<div class="line">    myHeartbeatTimer = setInterval(function() {</div>
<div class="line">      connection.prepareHeartbeatRequest(forge.util.createBuffer(&#39;1234&#39;));</div>
<div class="line">    }, 5*60*1000);*/</div>
<div class="line">  },</div>
<div class="line">  /* provide a client-side cert if you want</div>
<div class="line">  getCertificate: function(connection, hint) {</div>
<div class="line">    return myClientCertificate;</div>
<div class="line">  },</div>
<div class="line">  /* the private key for the client-side cert if provided */</div>
<div class="line">  getPrivateKey: function(connection, cert) {</div>
<div class="line">    return myClientPrivateKey;</div>
<div class="line">  },</div>
<div class="line">  tlsDataReady: function(connection) {</div>
<div class="line">    // TLS data (encrypted) is ready to be sent to the server</div>
<div class="line">    sendToServerSomehow(connection.tlsData.getBytes());</div>
<div class="line">    // if you were communicating with the server below, you&#39;d do:</div>
<div class="line">    // server.process(connection.tlsData.getBytes());</div>
<div class="line">  },</div>
<div class="line">  dataReady: function(connection) {</div>
<div class="line">    // clear data from the server is ready</div>
<div class="line">    console.log(&#39;the server sent: &#39; +</div>
<div class="line">      forge.util.decodeUtf8(connection.data.getBytes()));</div>
<div class="line">    // close connection</div>
<div class="line">    connection.close();</div>
<div class="line">  },</div>
<div class="line">  /* NOTE: experimental</div>
<div class="line">  heartbeatReceived: function(connection, payload) {</div>
<div class="line">    // restart retransmission timer, look at payload</div>
<div class="line">    clearInterval(myHeartbeatTimer);</div>
<div class="line">    myHeartbeatTimer = setInterval(function() {</div>
<div class="line">      connection.prepareHeartbeatRequest(forge.util.createBuffer(&#39;1234&#39;));</div>
<div class="line">    }, 5*60*1000);</div>
<div class="line">    payload.getBytes();</div>
<div class="line">  },*/</div>
<div class="line">  closed: function(connection) {</div>
<div class="line">    console.log(&#39;disconnected&#39;);</div>
<div class="line">  },</div>
<div class="line">  error: function(connection, error) {</div>
<div class="line">    console.log(&#39;uh oh&#39;, error);</div>
<div class="line">  }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// start the handshake process</div>
<div class="line">client.handshake();</div>
<div class="line"> </div>
<div class="line">// when encrypted TLS data is received from the server, process it</div>
<div class="line">client.process(encryptedBytesFromServer);</div>
<div class="line"> </div>
<div class="line">// create TLS server</div>
<div class="line">var server = forge.tls.createConnection({</div>
<div class="line">  server: true,</div>
<div class="line">  caStore: /* Array of PEM-formatted certs or a CA store object */,</div>
<div class="line">  sessionCache: {},</div>
<div class="line">  // supported cipher suites in order of preference</div>
<div class="line">  cipherSuites: [</div>
<div class="line">    forge.tls.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA,</div>
<div class="line">    forge.tls.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA],</div>
<div class="line">  // require a client-side certificate if you want</div>
<div class="line">  verifyClient: true,</div>
<div class="line">  verify: function(connection, verified, depth, certs) {</div>
<div class="line">    if(depth === 0) {</div>
<div class="line">      var cn = certs[0].subject.getField(&#39;CN&#39;).value;</div>
<div class="line">      if(cn !== &#39;the-client&#39;) {</div>
<div class="line">        verified = {</div>
<div class="line">          alert: forge.tls.Alert.Description.bad_certificate,</div>
<div class="line">          message: &#39;Certificate common name does not match expected client.&#39;</div>
<div class="line">        };</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    return verified;</div>
<div class="line">  },</div>
<div class="line">  connected: function(connection) {</div>
<div class="line">    console.log(&#39;connected&#39;);</div>
<div class="line">    // send message to client</div>
<div class="line">    connection.prepare(forge.util.encodeUtf8(&#39;Hi client!&#39;));</div>
<div class="line">    /* NOTE: experimental, start heartbeat retransmission timer</div>
<div class="line">    myHeartbeatTimer = setInterval(function() {</div>
<div class="line">      connection.prepareHeartbeatRequest(forge.util.createBuffer(&#39;1234&#39;));</div>
<div class="line">    }, 5*60*1000);*/</div>
<div class="line">  },</div>
<div class="line">  getCertificate: function(connection, hint) {</div>
<div class="line">    return myServerCertificate;</div>
<div class="line">  },</div>
<div class="line">  getPrivateKey: function(connection, cert) {</div>
<div class="line">    return myServerPrivateKey;</div>
<div class="line">  },</div>
<div class="line">  tlsDataReady: function(connection) {</div>
<div class="line">    // TLS data (encrypted) is ready to be sent to the client</div>
<div class="line">    sendToClientSomehow(connection.tlsData.getBytes());</div>
<div class="line">    // if you were communicating with the client above you&#39;d do:</div>
<div class="line">    // client.process(connection.tlsData.getBytes());</div>
<div class="line">  },</div>
<div class="line">  dataReady: function(connection) {</div>
<div class="line">    // clear data from the client is ready</div>
<div class="line">    console.log(&#39;the client sent: &#39; +</div>
<div class="line">      forge.util.decodeUtf8(connection.data.getBytes()));</div>
<div class="line">    // close connection</div>
<div class="line">    connection.close();</div>
<div class="line">  },</div>
<div class="line">  /* NOTE: experimental</div>
<div class="line">  heartbeatReceived: function(connection, payload) {</div>
<div class="line">    // restart retransmission timer, look at payload</div>
<div class="line">    clearInterval(myHeartbeatTimer);</div>
<div class="line">    myHeartbeatTimer = setInterval(function() {</div>
<div class="line">      connection.prepareHeartbeatRequest(forge.util.createBuffer(&#39;1234&#39;));</div>
<div class="line">    }, 5*60*1000);</div>
<div class="line">    payload.getBytes();</div>
<div class="line">  },*/</div>
<div class="line">  closed: function(connection) {</div>
<div class="line">    console.log(&#39;disconnected&#39;);</div>
<div class="line">  },</div>
<div class="line">  error: function(connection, error) {</div>
<div class="line">    console.log(&#39;uh oh&#39;, error);</div>
<div class="line">  }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// when encrypted TLS data is received from the client, process it</div>
<div class="line">server.process(encryptedBytesFromClient);</div>
</div><!-- fragment --><p>Connect to a TLS server using node's net.Socket:</p>
<div class="fragment"><div class="line">var socket = new net.Socket();</div>
<div class="line"> </div>
<div class="line">var client = forge.tls.createConnection({</div>
<div class="line">  server: false,</div>
<div class="line">  verify: function(connection, verified, depth, certs) {</div>
<div class="line">    // skip verification for testing</div>
<div class="line">    console.log(&#39;[tls] server certificate verified&#39;);</div>
<div class="line">    return true;</div>
<div class="line">  },</div>
<div class="line">  connected: function(connection) {</div>
<div class="line">    console.log(&#39;[tls] connected&#39;);</div>
<div class="line">    // prepare some data to send (note that the string is interpreted as</div>
<div class="line">    // &#39;binary&#39; encoded, which works for HTTP which only uses ASCII, use</div>
<div class="line">    // forge.util.encodeUtf8(str) otherwise</div>
<div class="line">    client.prepare(&#39;GET / HTTP/1.0\r\n\r\n&#39;);</div>
<div class="line">  },</div>
<div class="line">  tlsDataReady: function(connection) {</div>
<div class="line">    // encrypted data is ready to be sent to the server</div>
<div class="line">    var data = connection.tlsData.getBytes();</div>
<div class="line">    socket.write(data, &#39;binary&#39;); // encoding should be &#39;binary&#39;</div>
<div class="line">  },</div>
<div class="line">  dataReady: function(connection) {</div>
<div class="line">    // clear data from the server is ready</div>
<div class="line">    var data = connection.data.getBytes();</div>
<div class="line">    console.log(&#39;[tls] data received from the server: &#39; + data);</div>
<div class="line">  },</div>
<div class="line">  closed: function() {</div>
<div class="line">    console.log(&#39;[tls] disconnected&#39;);</div>
<div class="line">  },</div>
<div class="line">  error: function(connection, error) {</div>
<div class="line">    console.log(&#39;[tls] error&#39;, error);</div>
<div class="line">  }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">socket.on(&#39;connect&#39;, function() {</div>
<div class="line">  console.log(&#39;[socket] connected&#39;);</div>
<div class="line">  client.handshake();</div>
<div class="line">});</div>
<div class="line">socket.on(&#39;data&#39;, function(data) {</div>
<div class="line">  client.process(data.toString(&#39;binary&#39;)); // encoding should be &#39;binary&#39;</div>
<div class="line">});</div>
<div class="line">socket.on(&#39;end&#39;, function() {</div>
<div class="line">  console.log(&#39;[socket] disconnected&#39;);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// connect to google.com</div>
<div class="line">socket.connect(443, &#39;google.com&#39;);</div>
<div class="line"> </div>
<div class="line">// or connect to gmail&#39;s imap server (but don&#39;t send the HTTP header above)</div>
<div class="line">//socket.connect(993, &#39;imap.gmail.com&#39;);</div>
</div><!-- fragment --><p><a class="anchor" id="http"></a></p>
<h2><a class="anchor" id="autotoc_md17401"></a>
HTTP</h2>
<p>Provides a native <a href="https://en.wikipedia.org/wiki/JavaScript">JavaScript</a> mini-implementation of an http client that uses pooled sockets.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// create an HTTP GET request</div>
<div class="line">var request = forge.http.createRequest({method: &#39;GET&#39;, path: url.path});</div>
<div class="line"> </div>
<div class="line">// send the request somewhere</div>
<div class="line">sendSomehow(request.toString());</div>
<div class="line"> </div>
<div class="line">// receive response</div>
<div class="line">var buffer = forge.util.createBuffer();</div>
<div class="line">var response = forge.http.createResponse();</div>
<div class="line">var someAsyncDataHandler = function(bytes) {</div>
<div class="line">  if(!response.bodyReceived) {</div>
<div class="line">    buffer.putBytes(bytes);</div>
<div class="line">    if(!response.headerReceived) {</div>
<div class="line">      if(response.readHeader(buffer)) {</div>
<div class="line">        console.log(&#39;HTTP response header: &#39; + response.toString());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    if(response.headerReceived &amp;&amp; !response.bodyReceived) {</div>
<div class="line">      if(response.readBody(buffer)) {</div>
<div class="line">        console.log(&#39;HTTP response body: &#39; + response.body);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="ssh"></a></p>
<h2><a class="anchor" id="autotoc_md17402"></a>
SSH</h2>
<p>Provides some SSH utility functions.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// encodes (and optionally encrypts) a private RSA key as a Putty PPK file</div>
<div class="line">forge.ssh.privateKeyToPutty(privateKey, passphrase, comment);</div>
<div class="line"> </div>
<div class="line">// encodes a public RSA key as an OpenSSH file</div>
<div class="line">forge.ssh.publicKeyToOpenSSH(key, comment);</div>
<div class="line"> </div>
<div class="line">// encodes a private RSA key as an OpenSSH file</div>
<div class="line">forge.ssh.privateKeyToOpenSSH(privateKey, passphrase);</div>
<div class="line"> </div>
<div class="line">// gets the SSH public key fingerprint in a byte buffer</div>
<div class="line">forge.ssh.getPublicKeyFingerprint(key);</div>
<div class="line"> </div>
<div class="line">// gets a hex-encoded, colon-delimited SSH public key fingerprint</div>
<div class="line">forge.ssh.getPublicKeyFingerprint(key, {encoding: &#39;hex&#39;, delimiter: &#39;:&#39;});</div>
</div><!-- fragment --><p><a class="anchor" id="xhr"></a></p>
<h2><a class="anchor" id="autotoc_md17403"></a>
XHR</h2>
<p>Provides an XmlHttpRequest implementation using forge.http as a backend.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// TODO</div>
</div><!-- fragment --><p><a class="anchor" id="socket"></a></p>
<h2><a class="anchor" id="autotoc_md17404"></a>
Sockets</h2>
<p>Provides an interface to create and use raw sockets provided via Flash.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// TODO</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17405"></a>
Ciphers</h1>
<p><a class="anchor" id="cipher"></a></p>
<h2><a class="anchor" id="autotoc_md17406"></a>
CIPHER</h2>
<p>Provides a basic API for block encryption and decryption. There is built-in support for the ciphers: <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a>, <a href="https://en.wikipedia.org/wiki/Triple_DES">3DES</a>, and <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a>, and for the modes of operation: <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">ECB</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CBC</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CFB</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">OFB</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CTR</a>, and <a href="https://en.wikipedia.org/wiki/GCM_mode">GCM</a>.</p>
<p>These algorithms are currently supported:</p>
<ul>
<li>AES-ECB</li>
<li>AES-CBC</li>
<li>AES-CFB</li>
<li>AES-OFB</li>
<li>AES-CTR</li>
<li>AES-GCM</li>
<li>3DES-ECB</li>
<li>3DES-CBC</li>
<li>DES-ECB</li>
<li>DES-CBC</li>
</ul>
<p>When using an <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> algorithm, the key size will determine whether AES-128, AES-192, or AES-256 is used (all are supported). When a <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> algorithm is used, the key size will determine whether <a href="https://en.wikipedia.org/wiki/Triple_DES">3DES</a> or regular <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> is used. Use a <a href="https://en.wikipedia.org/wiki/Triple_DES">3DES</a> algorithm to enforce Triple-DES.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate a random key and IV</div>
<div class="line">// Note: a key size of 16 bytes will use AES-128, 24 =&gt; AES-192, 32 =&gt; AES-256</div>
<div class="line">var key = forge.random.getBytesSync(16);</div>
<div class="line">var iv = forge.random.getBytesSync(16);</div>
<div class="line"> </div>
<div class="line">/* alternatively, generate a password-based 16-byte key</div>
<div class="line">var salt = forge.random.getBytesSync(128);</div>
<div class="line">var key = forge.pkcs5.pbkdf2(&#39;password&#39;, salt, numIterations, 16);</div>
<div class="line">*/</div>
<div class="line"> </div>
<div class="line">// encrypt some bytes using CBC mode</div>
<div class="line">// (other modes include: ECB, CFB, OFB, CTR, and GCM)</div>
<div class="line">// Note: CBC and ECB modes use PKCS#7 padding as default</div>
<div class="line">var cipher = forge.cipher.createCipher(&#39;AES-CBC&#39;, key);</div>
<div class="line">cipher.start({iv: iv});</div>
<div class="line">cipher.update(forge.util.createBuffer(someBytes));</div>
<div class="line">cipher.finish();</div>
<div class="line">var encrypted = cipher.output;</div>
<div class="line">// outputs encrypted hex</div>
<div class="line">console.log(encrypted.toHex());</div>
<div class="line"> </div>
<div class="line">// decrypt some bytes using CBC mode</div>
<div class="line">// (other modes include: CFB, OFB, CTR, and GCM)</div>
<div class="line">var decipher = forge.cipher.createDecipher(&#39;AES-CBC&#39;, key);</div>
<div class="line">decipher.start({iv: iv});</div>
<div class="line">decipher.update(encrypted);</div>
<div class="line">var result = decipher.finish(); // check &#39;result&#39; for true/false</div>
<div class="line">// outputs decrypted hex</div>
<div class="line">console.log(decipher.output.toHex());</div>
<div class="line"> </div>
<div class="line">// decrypt bytes using CBC mode and streaming</div>
<div class="line">// Performance can suffer for large multi-MB inputs due to buffer</div>
<div class="line">// manipulations. Stream processing in chunks can offer significant</div>
<div class="line">// improvement. CPU intensive update() calls could also be performed with</div>
<div class="line">// setImmediate/setTimeout to avoid blocking the main browser UI thread (not</div>
<div class="line">// shown here). Optimal block size depends on the JavaScript VM and other</div>
<div class="line">// factors. Encryption can use a simple technique for increased performance.</div>
<div class="line">var encryptedBytes = encrypted.bytes();</div>
<div class="line">var decipher = forge.cipher.createDecipher(&#39;AES-CBC&#39;, key);</div>
<div class="line">decipher.start({iv: iv});</div>
<div class="line">var length = encryptedBytes.length;</div>
<div class="line">var chunkSize = 1024 * 64;</div>
<div class="line">var index = 0;</div>
<div class="line">var decrypted = &#39;&#39;;</div>
<div class="line">do {</div>
<div class="line">  decrypted += decipher.output.getBytes();</div>
<div class="line">  var buf = forge.util.createBuffer(encryptedBytes.substr(index, chunkSize));</div>
<div class="line">  decipher.update(buf);</div>
<div class="line">  index += chunkSize;</div>
<div class="line">} while(index &lt; length);</div>
<div class="line">var result = decipher.finish();</div>
<div class="line">assert(result);</div>
<div class="line">decrypted += decipher.output.getBytes();</div>
<div class="line">console.log(forge.util.bytesToHex(decrypted));</div>
<div class="line"> </div>
<div class="line">// encrypt some bytes using GCM mode</div>
<div class="line">var cipher = forge.cipher.createCipher(&#39;AES-GCM&#39;, key);</div>
<div class="line">cipher.start({</div>
<div class="line">  iv: iv, // should be a 12-byte binary-encoded string or byte buffer</div>
<div class="line">  additionalData: &#39;binary-encoded string&#39;, // optional</div>
<div class="line">  tagLength: 128 // optional, defaults to 128 bits</div>
<div class="line">});</div>
<div class="line">cipher.update(forge.util.createBuffer(someBytes));</div>
<div class="line">cipher.finish();</div>
<div class="line">var encrypted = cipher.output;</div>
<div class="line">var tag = cipher.mode.tag;</div>
<div class="line">// outputs encrypted hex</div>
<div class="line">console.log(encrypted.toHex());</div>
<div class="line">// outputs authentication tag</div>
<div class="line">console.log(tag.toHex());</div>
<div class="line"> </div>
<div class="line">// decrypt some bytes using GCM mode</div>
<div class="line">var decipher = forge.cipher.createDecipher(&#39;AES-GCM&#39;, key);</div>
<div class="line">decipher.start({</div>
<div class="line">  iv: iv,</div>
<div class="line">  additionalData: &#39;binary-encoded string&#39;, // optional</div>
<div class="line">  tagLength: 128, // optional, defaults to 128 bits</div>
<div class="line">  tag: tag // authentication tag from encryption</div>
<div class="line">});</div>
<div class="line">decipher.update(encrypted);</div>
<div class="line">var pass = decipher.finish();</div>
<div class="line">// pass is false if there was a failure (eg: authentication tag didn&#39;t match)</div>
<div class="line">if(pass) {</div>
<div class="line">  // outputs decrypted hex</div>
<div class="line">  console.log(decipher.output.toHex());</div>
<div class="line">}</div>
</div><!-- fragment --><p>Using forge in Node.js to match openssl's "enc" command line tool (<b>Note</b>: OpenSSL "enc" uses a non-standard file format with a custom key derivation function and a fixed iteration count of 1, which some consider less secure than alternatives such as <a href="https://tools.ietf.org/html/rfc4880">OpenPGP</a>/<a href="https://www.gnupg.org/">GnuPG</a>):</p>
<div class="fragment"><div class="line">var forge = require(&#39;node-forge&#39;);</div>
<div class="line">var fs = require(&#39;fs&#39;);</div>
<div class="line"> </div>
<div class="line">// openssl enc -des3 -in input.txt -out input.enc</div>
<div class="line">function encrypt(password) {</div>
<div class="line">  var input = fs.readFileSync(&#39;input.txt&#39;, {encoding: &#39;binary&#39;});</div>
<div class="line"> </div>
<div class="line">  // 3DES key and IV sizes</div>
<div class="line">  var keySize = 24;</div>
<div class="line">  var ivSize = 8;</div>
<div class="line"> </div>
<div class="line">  // get derived bytes</div>
<div class="line">  // Notes:</div>
<div class="line">  // 1. If using an alternative hash (eg: &quot;-md sha1&quot;) pass</div>
<div class="line">  //   &quot;forge.md.sha1.create()&quot; as the final parameter.</div>
<div class="line">  // 2. If using &quot;-nosalt&quot;, set salt to null.</div>
<div class="line">  var salt = forge.random.getBytesSync(8);</div>
<div class="line">  // var md = forge.md.sha1.create(); // &quot;-md sha1&quot;</div>
<div class="line">  var derivedBytes = forge.pbe.opensslDeriveBytes(</div>
<div class="line">    password, salt, keySize + ivSize/*, md*/);</div>
<div class="line">  var buffer = forge.util.createBuffer(derivedBytes);</div>
<div class="line">  var key = buffer.getBytes(keySize);</div>
<div class="line">  var iv = buffer.getBytes(ivSize);</div>
<div class="line"> </div>
<div class="line">  var cipher = forge.cipher.createCipher(&#39;3DES-CBC&#39;, key);</div>
<div class="line">  cipher.start({iv: iv});</div>
<div class="line">  cipher.update(forge.util.createBuffer(input, &#39;binary&#39;));</div>
<div class="line">  cipher.finish();</div>
<div class="line"> </div>
<div class="line">  var output = forge.util.createBuffer();</div>
<div class="line"> </div>
<div class="line">  // if using a salt, prepend this to the output:</div>
<div class="line">  if(salt !== null) {</div>
<div class="line">    output.putBytes(&#39;Salted__&#39;); // (add to match openssl tool output)</div>
<div class="line">    output.putBytes(salt);</div>
<div class="line">  }</div>
<div class="line">  output.putBuffer(cipher.output);</div>
<div class="line"> </div>
<div class="line">  fs.writeFileSync(&#39;input.enc&#39;, output.getBytes(), {encoding: &#39;binary&#39;});</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// openssl enc -d -des3 -in input.enc -out input.dec.txt</div>
<div class="line">function decrypt(password) {</div>
<div class="line">  var input = fs.readFileSync(&#39;input.enc&#39;, {encoding: &#39;binary&#39;});</div>
<div class="line"> </div>
<div class="line">  // parse salt from input</div>
<div class="line">  input = forge.util.createBuffer(input, &#39;binary&#39;);</div>
<div class="line">  // skip &quot;Salted__&quot; (if known to be present)</div>
<div class="line">  input.getBytes(&#39;Salted__&#39;.length);</div>
<div class="line">  // read 8-byte salt</div>
<div class="line">  var salt = input.getBytes(8);</div>
<div class="line"> </div>
<div class="line">  // Note: if using &quot;-nosalt&quot;, skip above parsing and use</div>
<div class="line">  // var salt = null;</div>
<div class="line"> </div>
<div class="line">  // 3DES key and IV sizes</div>
<div class="line">  var keySize = 24;</div>
<div class="line">  var ivSize = 8;</div>
<div class="line"> </div>
<div class="line">  var derivedBytes = forge.pbe.opensslDeriveBytes(</div>
<div class="line">    password, salt, keySize + ivSize);</div>
<div class="line">  var buffer = forge.util.createBuffer(derivedBytes);</div>
<div class="line">  var key = buffer.getBytes(keySize);</div>
<div class="line">  var iv = buffer.getBytes(ivSize);</div>
<div class="line"> </div>
<div class="line">  var decipher = forge.cipher.createDecipher(&#39;3DES-CBC&#39;, key);</div>
<div class="line">  decipher.start({iv: iv});</div>
<div class="line">  decipher.update(input);</div>
<div class="line">  var result = decipher.finish(); // check &#39;result&#39; for true/false</div>
<div class="line"> </div>
<div class="line">  fs.writeFileSync(</div>
<div class="line">    &#39;input.dec.txt&#39;, decipher.output.getBytes(), {encoding: &#39;binary&#39;});</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="aes"></a></p>
<h2><a class="anchor" id="autotoc_md17407"></a>
AES</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> encryption and decryption in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CBC</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CFB</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">OFB</a>, <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CTR</a>, and <a href="https://en.wikipedia.org/wiki/GCM_mode">GCM</a> modes. See <a href="#cipher">CIPHER</a> for examples.</p>
<p><a class="anchor" id="des"></a></p>
<h2><a class="anchor" id="autotoc_md17408"></a>
DES</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/Triple_DES">3DES</a> and <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> encryption and decryption in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">ECB</a> and <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CBC</a> modes. See <a href="#cipher">CIPHER</a> for examples.</p>
<p><a class="anchor" id="rc2"></a></p>
<h2><a class="anchor" id="autotoc_md17409"></a>
RC2</h2>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate a random key and IV</div>
<div class="line">var key = forge.random.getBytesSync(16);</div>
<div class="line">var iv = forge.random.getBytesSync(8);</div>
<div class="line"> </div>
<div class="line">// encrypt some bytes</div>
<div class="line">var cipher = forge.rc2.createEncryptionCipher(key);</div>
<div class="line">cipher.start(iv);</div>
<div class="line">cipher.update(forge.util.createBuffer(someBytes));</div>
<div class="line">cipher.finish();</div>
<div class="line">var encrypted = cipher.output;</div>
<div class="line">// outputs encrypted hex</div>
<div class="line">console.log(encrypted.toHex());</div>
<div class="line"> </div>
<div class="line">// decrypt some bytes</div>
<div class="line">var cipher = forge.rc2.createDecryptionCipher(key);</div>
<div class="line">cipher.start(iv);</div>
<div class="line">cipher.update(encrypted);</div>
<div class="line">cipher.finish();</div>
<div class="line">// outputs decrypted hex</div>
<div class="line">console.log(cipher.output.toHex());</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17410"></a>
PKI</h1>
<p>Provides <a href="https://en.wikipedia.org/wiki/X.509">X.509</a> certificate support, ED25519 key generation and signing/verifying, and RSA public and private key encoding, decoding, encryption/decryption, and signing/verifying.</p>
<p><a class="anchor" id="ed25519"></a></p>
<h2><a class="anchor" id="autotoc_md17411"></a>
ED25519</h2>
<p>Special thanks to <a href="https://github.com/dchest/tweetnacl-js">TweetNaCl.js</a> for providing the bulk of the implementation.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var ed25519 = forge.pki.ed25519;</div>
<div class="line"> </div>
<div class="line">// generate a random ED25519 keypair</div>
<div class="line">var keypair = ed25519.generateKeyPair();</div>
<div class="line">// `keypair.publicKey` is a node.js Buffer or Uint8Array</div>
<div class="line">// `keypair.privateKey` is a node.js Buffer or Uint8Array</div>
<div class="line"> </div>
<div class="line">// generate a random ED25519 keypair based on a random 32-byte seed</div>
<div class="line">var seed = forge.random.getBytesSync(32);</div>
<div class="line">var keypair = ed25519.generateKeyPair({seed: seed});</div>
<div class="line"> </div>
<div class="line">// generate a random ED25519 keypair based on a &quot;password&quot; 32-byte seed</div>
<div class="line">var password = &#39;Mai9ohgh6ahxee0jutheew0pungoozil&#39;;</div>
<div class="line">var seed = new forge.util.ByteBuffer(password, &#39;utf8&#39;);</div>
<div class="line">var keypair = ed25519.generateKeyPair({seed: seed});</div>
<div class="line"> </div>
<div class="line">// sign a UTF-8 message</div>
<div class="line">var signature = ED25519.sign({</div>
<div class="line">  message: &#39;test&#39;,</div>
<div class="line">  // also accepts `binary` if you want to pass a binary string</div>
<div class="line">  encoding: &#39;utf8&#39;,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, binary string</div>
<div class="line">  privateKey: privateKey</div>
<div class="line">});</div>
<div class="line">// `signature` is a node.js Buffer or Uint8Array</div>
<div class="line"> </div>
<div class="line">// sign a message passed as a buffer</div>
<div class="line">var signature = ED25519.sign({</div>
<div class="line">  // also accepts a forge ByteBuffer or Uint8Array</div>
<div class="line">  message: Buffer.from(&#39;test&#39;, &#39;utf8&#39;),</div>
<div class="line">  privateKey: privateKey</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// sign a message digest (shorter &quot;message&quot; == better performance)</div>
<div class="line">var md = forge.md.sha256.create();</div>
<div class="line">md.update(&#39;test&#39;, &#39;utf8&#39;);</div>
<div class="line">var signature = ED25519.sign({</div>
<div class="line">  md: md,</div>
<div class="line">  privateKey: privateKey</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// verify a signature on a UTF-8 message</div>
<div class="line">var verified = ED25519.verify({</div>
<div class="line">  message: &#39;test&#39;,</div>
<div class="line">  encoding: &#39;utf8&#39;,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  signature: signature,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  publicKey: publicKey</div>
<div class="line">});</div>
<div class="line">// `verified` is true/false</div>
<div class="line"> </div>
<div class="line">// sign a message passed as a buffer</div>
<div class="line">var verified = ED25519.verify({</div>
<div class="line">  // also accepts a forge ByteBuffer or Uint8Array</div>
<div class="line">  message: Buffer.from(&#39;test&#39;, &#39;utf8&#39;),</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  signature: signature,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  publicKey: publicKey</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// verify a signature on a message digest</div>
<div class="line">var md = forge.md.sha256.create();</div>
<div class="line">md.update(&#39;test&#39;, &#39;utf8&#39;);</div>
<div class="line">var verified = ED25519.verify({</div>
<div class="line">  md: md,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  signature: signature,</div>
<div class="line">  // node.js Buffer, Uint8Array, forge ByteBuffer, or binary string</div>
<div class="line">  publicKey: publicKey</div>
<div class="line">});</div>
</div><!-- fragment --><p><a class="anchor" id="rsa"></a></p>
<h2><a class="anchor" id="autotoc_md17412"></a>
RSA</h2>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var rsa = forge.pki.rsa;</div>
<div class="line"> </div>
<div class="line">// generate an RSA key pair synchronously</div>
<div class="line">// *NOT RECOMMENDED*: Can be significantly slower than async and may block</div>
<div class="line">// JavaScript execution. Will use native Node.js 10.12.0+ API if possible.</div>
<div class="line">var keypair = rsa.generateKeyPair({bits: 2048, e: 0x10001});</div>
<div class="line"> </div>
<div class="line">// generate an RSA key pair asynchronously (uses web workers if available)</div>
<div class="line">// use workers: -1 to run a fast core estimator to optimize # of workers</div>
<div class="line">// *RECOMMENDED*: Can be significantly faster than sync. Will use native</div>
<div class="line">// Node.js 10.12.0+ or WebCrypto API if possible.</div>
<div class="line">rsa.generateKeyPair({bits: 2048, workers: 2}, function(err, keypair) {</div>
<div class="line">  // keypair.privateKey, keypair.publicKey</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// generate an RSA key pair in steps that attempt to run for a specified period</div>
<div class="line">// of time on the main JS thread</div>
<div class="line">var state = rsa.createKeyPairGenerationState(2048, 0x10001);</div>
<div class="line">var step = function() {</div>
<div class="line">  // run for 100 ms</div>
<div class="line">  if(!rsa.stepKeyPairGenerationState(state, 100)) {</div>
<div class="line">    setTimeout(step, 1);</div>
<div class="line">  }</div>
<div class="line">  else {</div>
<div class="line">    // done, turn off progress indicator, use state.keys</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line">// turn on progress indicator, schedule generation to run</div>
<div class="line">setTimeout(step);</div>
<div class="line"> </div>
<div class="line">// sign data with a private key and output DigestInfo DER-encoded bytes</div>
<div class="line">// (defaults to RSASSA PKCS#1 v1.5)</div>
<div class="line">var md = forge.md.sha1.create();</div>
<div class="line">md.update(&#39;sign this&#39;, &#39;utf8&#39;);</div>
<div class="line">var signature = privateKey.sign(md);</div>
<div class="line"> </div>
<div class="line">// verify data with a public key</div>
<div class="line">// (defaults to RSASSA PKCS#1 v1.5)</div>
<div class="line">var verified = publicKey.verify(md.digest().bytes(), signature);</div>
<div class="line"> </div>
<div class="line">// sign data using RSASSA-PSS where PSS uses a SHA-1 hash, a SHA-1 based</div>
<div class="line">// masking function MGF1, and a 20 byte salt</div>
<div class="line">var md = forge.md.sha1.create();</div>
<div class="line">md.update(&#39;sign this&#39;, &#39;utf8&#39;);</div>
<div class="line">var pss = forge.pss.create({</div>
<div class="line">  md: forge.md.sha1.create(),</div>
<div class="line">  mgf: forge.mgf.mgf1.create(forge.md.sha1.create()),</div>
<div class="line">  saltLength: 20</div>
<div class="line">  // optionally pass &#39;prng&#39; with a custom PRNG implementation</div>
<div class="line">  // optionalls pass &#39;salt&#39; with a forge.util.ByteBuffer w/custom salt</div>
<div class="line">});</div>
<div class="line">var signature = privateKey.sign(md, pss);</div>
<div class="line"> </div>
<div class="line">// verify RSASSA-PSS signature</div>
<div class="line">var pss = forge.pss.create({</div>
<div class="line">  md: forge.md.sha1.create(),</div>
<div class="line">  mgf: forge.mgf.mgf1.create(forge.md.sha1.create()),</div>
<div class="line">  saltLength: 20</div>
<div class="line">  // optionally pass &#39;prng&#39; with a custom PRNG implementation</div>
<div class="line">});</div>
<div class="line">var md = forge.md.sha1.create();</div>
<div class="line">md.update(&#39;sign this&#39;, &#39;utf8&#39;);</div>
<div class="line">publicKey.verify(md.digest().getBytes(), signature, pss);</div>
<div class="line"> </div>
<div class="line">// encrypt data with a public key (defaults to RSAES PKCS#1 v1.5)</div>
<div class="line">var encrypted = publicKey.encrypt(bytes);</div>
<div class="line"> </div>
<div class="line">// decrypt data with a private key (defaults to RSAES PKCS#1 v1.5)</div>
<div class="line">var decrypted = privateKey.decrypt(encrypted);</div>
<div class="line"> </div>
<div class="line">// encrypt data with a public key using RSAES PKCS#1 v1.5</div>
<div class="line">var encrypted = publicKey.encrypt(bytes, &#39;RSAES-PKCS1-V1_5&#39;);</div>
<div class="line"> </div>
<div class="line">// decrypt data with a private key using RSAES PKCS#1 v1.5</div>
<div class="line">var decrypted = privateKey.decrypt(encrypted, &#39;RSAES-PKCS1-V1_5&#39;);</div>
<div class="line"> </div>
<div class="line">// encrypt data with a public key using RSAES-OAEP</div>
<div class="line">var encrypted = publicKey.encrypt(bytes, &#39;RSA-OAEP&#39;);</div>
<div class="line"> </div>
<div class="line">// decrypt data with a private key using RSAES-OAEP</div>
<div class="line">var decrypted = privateKey.decrypt(encrypted, &#39;RSA-OAEP&#39;);</div>
<div class="line"> </div>
<div class="line">// encrypt data with a public key using RSAES-OAEP/SHA-256</div>
<div class="line">var encrypted = publicKey.encrypt(bytes, &#39;RSA-OAEP&#39;, {</div>
<div class="line">  md: forge.md.sha256.create()</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// decrypt data with a private key using RSAES-OAEP/SHA-256</div>
<div class="line">var decrypted = privateKey.decrypt(encrypted, &#39;RSA-OAEP&#39;, {</div>
<div class="line">  md: forge.md.sha256.create()</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// encrypt data with a public key using RSAES-OAEP/SHA-256/MGF1-SHA-1</div>
<div class="line">// compatible with Java&#39;s RSA/ECB/OAEPWithSHA-256AndMGF1Padding</div>
<div class="line">var encrypted = publicKey.encrypt(bytes, &#39;RSA-OAEP&#39;, {</div>
<div class="line">  md: forge.md.sha256.create(),</div>
<div class="line">  mgf1: {</div>
<div class="line">    md: forge.md.sha1.create()</div>
<div class="line">  }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// decrypt data with a private key using RSAES-OAEP/SHA-256/MGF1-SHA-1</div>
<div class="line">// compatible with Java&#39;s RSA/ECB/OAEPWithSHA-256AndMGF1Padding</div>
<div class="line">var decrypted = privateKey.decrypt(encrypted, &#39;RSA-OAEP&#39;, {</div>
<div class="line">  md: forge.md.sha256.create(),</div>
<div class="line">  mgf1: {</div>
<div class="line">    md: forge.md.sha1.create()</div>
<div class="line">  }</div>
<div class="line">});</div>
</div><!-- fragment --><p><a class="anchor" id="rsakem"></a></p>
<h2><a class="anchor" id="autotoc_md17413"></a>
RSA-KEM</h2>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate an RSA key pair asynchronously (uses web workers if available)</div>
<div class="line">// use workers: -1 to run a fast core estimator to optimize # of workers</div>
<div class="line">forge.rsa.generateKeyPair({bits: 2048, workers: -1}, function(err, keypair) {</div>
<div class="line">  // keypair.privateKey, keypair.publicKey</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// generate and encapsulate a 16-byte secret key</div>
<div class="line">var kdf1 = new forge.kem.kdf1(forge.md.sha1.create());</div>
<div class="line">var kem = forge.kem.rsa.create(kdf1);</div>
<div class="line">var result = kem.encrypt(keypair.publicKey, 16);</div>
<div class="line">// result has &#39;encapsulation&#39; and &#39;key&#39;</div>
<div class="line"> </div>
<div class="line">// encrypt some bytes</div>
<div class="line">var iv = forge.random.getBytesSync(12);</div>
<div class="line">var someBytes = &#39;hello world!&#39;;</div>
<div class="line">var cipher = forge.cipher.createCipher(&#39;AES-GCM&#39;, result.key);</div>
<div class="line">cipher.start({iv: iv});</div>
<div class="line">cipher.update(forge.util.createBuffer(someBytes));</div>
<div class="line">cipher.finish();</div>
<div class="line">var encrypted = cipher.output.getBytes();</div>
<div class="line">var tag = cipher.mode.tag.getBytes();</div>
<div class="line"> </div>
<div class="line">// send &#39;encrypted&#39;, &#39;iv&#39;, &#39;tag&#39;, and result.encapsulation to recipient</div>
<div class="line"> </div>
<div class="line">// decrypt encapsulated 16-byte secret key</div>
<div class="line">var kdf1 = new forge.kem.kdf1(forge.md.sha1.create());</div>
<div class="line">var kem = forge.kem.rsa.create(kdf1);</div>
<div class="line">var key = kem.decrypt(keypair.privateKey, result.encapsulation, 16);</div>
<div class="line"> </div>
<div class="line">// decrypt some bytes</div>
<div class="line">var decipher = forge.cipher.createDecipher(&#39;AES-GCM&#39;, key);</div>
<div class="line">decipher.start({iv: iv, tag: tag});</div>
<div class="line">decipher.update(forge.util.createBuffer(encrypted));</div>
<div class="line">var pass = decipher.finish();</div>
<div class="line">// pass is false if there was a failure (eg: authentication tag didn&#39;t match)</div>
<div class="line">if(pass) {</div>
<div class="line">  // outputs &#39;hello world!&#39;</div>
<div class="line">  console.log(decipher.output.getBytes());</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="x509"></a></p>
<h2><a class="anchor" id="autotoc_md17414"></a>
X.509</h2>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var pki = forge.pki;</div>
<div class="line"> </div>
<div class="line">// convert a PEM-formatted public key to a Forge public key</div>
<div class="line">var publicKey = pki.publicKeyFromPem(pem);</div>
<div class="line"> </div>
<div class="line">// convert a Forge public key to PEM-format</div>
<div class="line">var pem = pki.publicKeyToPem(publicKey);</div>
<div class="line"> </div>
<div class="line">// convert an ASN.1 SubjectPublicKeyInfo to a Forge public key</div>
<div class="line">var publicKey = pki.publicKeyFromAsn1(subjectPublicKeyInfo);</div>
<div class="line"> </div>
<div class="line">// convert a Forge public key to an ASN.1 SubjectPublicKeyInfo</div>
<div class="line">var subjectPublicKeyInfo = pki.publicKeyToAsn1(publicKey);</div>
<div class="line"> </div>
<div class="line">// gets a SHA-1 RSAPublicKey fingerprint a byte buffer</div>
<div class="line">pki.getPublicKeyFingerprint(key);</div>
<div class="line"> </div>
<div class="line">// gets a SHA-1 SubjectPublicKeyInfo fingerprint a byte buffer</div>
<div class="line">pki.getPublicKeyFingerprint(key, {type: &#39;SubjectPublicKeyInfo&#39;});</div>
<div class="line"> </div>
<div class="line">// gets a hex-encoded, colon-delimited SHA-1 RSAPublicKey public key fingerprint</div>
<div class="line">pki.getPublicKeyFingerprint(key, {encoding: &#39;hex&#39;, delimiter: &#39;:&#39;});</div>
<div class="line"> </div>
<div class="line">// gets a hex-encoded, colon-delimited SHA-1 SubjectPublicKeyInfo public key fingerprint</div>
<div class="line">pki.getPublicKeyFingerprint(key, {</div>
<div class="line">  type: &#39;SubjectPublicKeyInfo&#39;,</div>
<div class="line">  encoding: &#39;hex&#39;,</div>
<div class="line">  delimiter: &#39;:&#39;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// gets a hex-encoded, colon-delimited MD5 RSAPublicKey public key fingerprint</div>
<div class="line">pki.getPublicKeyFingerprint(key, {</div>
<div class="line">  md: forge.md.md5.create(),</div>
<div class="line">  encoding: &#39;hex&#39;,</div>
<div class="line">  delimiter: &#39;:&#39;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// creates a CA store</div>
<div class="line">var caStore = pki.createCaStore([/* PEM-encoded cert */, ...]);</div>
<div class="line"> </div>
<div class="line">// add a certificate to the CA store</div>
<div class="line">caStore.addCertificate(certObjectOrPemString);</div>
<div class="line"> </div>
<div class="line">// gets the issuer (its certificate) for the given certificate</div>
<div class="line">var issuerCert = caStore.getIssuer(subjectCert);</div>
<div class="line"> </div>
<div class="line">// verifies a certificate chain against a CA store</div>
<div class="line">pki.verifyCertificateChain(caStore, chain, customVerifyCallback);</div>
<div class="line"> </div>
<div class="line">// signs a certificate using the given private key</div>
<div class="line">cert.sign(privateKey);</div>
<div class="line"> </div>
<div class="line">// signs a certificate using SHA-256 instead of SHA-1</div>
<div class="line">cert.sign(privateKey, forge.md.sha256.create());</div>
<div class="line"> </div>
<div class="line">// verifies an issued certificate using the certificates public key</div>
<div class="line">var verified = issuer.verify(issued);</div>
<div class="line"> </div>
<div class="line">// generate a keypair and create an X.509v3 certificate</div>
<div class="line">var keys = pki.rsa.generateKeyPair(2048);</div>
<div class="line">var cert = pki.createCertificate();</div>
<div class="line">cert.publicKey = keys.publicKey;</div>
<div class="line">// alternatively set public key from a csr</div>
<div class="line">//cert.publicKey = csr.publicKey;</div>
<div class="line">// NOTE: serialNumber is the hex encoded value of an ASN.1 INTEGER.</div>
<div class="line">// Conforming CAs should ensure serialNumber is:</div>
<div class="line">// - no more than 20 octets</div>
<div class="line">// - non-negative (prefix a &#39;00&#39; if your value starts with a &#39;1&#39; bit)</div>
<div class="line">cert.serialNumber = &#39;01&#39;;</div>
<div class="line">cert.validity.notBefore = new Date();</div>
<div class="line">cert.validity.notAfter = new Date();</div>
<div class="line">cert.validity.notAfter.setFullYear(cert.validity.notBefore.getFullYear() + 1);</div>
<div class="line">var attrs = [{</div>
<div class="line">  name: &#39;commonName&#39;,</div>
<div class="line">  value: &#39;example.org&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;countryName&#39;,</div>
<div class="line">  value: &#39;US&#39;</div>
<div class="line">}, {</div>
<div class="line">  shortName: &#39;ST&#39;,</div>
<div class="line">  value: &#39;Virginia&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;localityName&#39;,</div>
<div class="line">  value: &#39;Blacksburg&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;organizationName&#39;,</div>
<div class="line">  value: &#39;Test&#39;</div>
<div class="line">}, {</div>
<div class="line">  shortName: &#39;OU&#39;,</div>
<div class="line">  value: &#39;Test&#39;</div>
<div class="line">}];</div>
<div class="line">cert.setSubject(attrs);</div>
<div class="line">// alternatively set subject from a csr</div>
<div class="line">//cert.setSubject(csr.subject.attributes);</div>
<div class="line">cert.setIssuer(attrs);</div>
<div class="line">cert.setExtensions([{</div>
<div class="line">  name: &#39;basicConstraints&#39;,</div>
<div class="line">  cA: true</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;keyUsage&#39;,</div>
<div class="line">  keyCertSign: true,</div>
<div class="line">  digitalSignature: true,</div>
<div class="line">  nonRepudiation: true,</div>
<div class="line">  keyEncipherment: true,</div>
<div class="line">  dataEncipherment: true</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;extKeyUsage&#39;,</div>
<div class="line">  serverAuth: true,</div>
<div class="line">  clientAuth: true,</div>
<div class="line">  codeSigning: true,</div>
<div class="line">  emailProtection: true,</div>
<div class="line">  timeStamping: true</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;nsCertType&#39;,</div>
<div class="line">  client: true,</div>
<div class="line">  server: true,</div>
<div class="line">  email: true,</div>
<div class="line">  objsign: true,</div>
<div class="line">  sslCA: true,</div>
<div class="line">  emailCA: true,</div>
<div class="line">  objCA: true</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;subjectAltName&#39;,</div>
<div class="line">  altNames: [{</div>
<div class="line">    type: 6, // URI</div>
<div class="line">    value: &#39;http://example.org/webid#me&#39;</div>
<div class="line">  }, {</div>
<div class="line">    type: 7, // IP</div>
<div class="line">    ip: &#39;127.0.0.1&#39;</div>
<div class="line">  }]</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;subjectKeyIdentifier&#39;</div>
<div class="line">}]);</div>
<div class="line">/* alternatively set extensions from a csr</div>
<div class="line">var extensions = csr.getAttribute({name: &#39;extensionRequest&#39;}).extensions;</div>
<div class="line">// optionally add more extensions</div>
<div class="line">extensions.push.apply(extensions, [{</div>
<div class="line">  name: &#39;basicConstraints&#39;,</div>
<div class="line">  cA: true</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;keyUsage&#39;,</div>
<div class="line">  keyCertSign: true,</div>
<div class="line">  digitalSignature: true,</div>
<div class="line">  nonRepudiation: true,</div>
<div class="line">  keyEncipherment: true,</div>
<div class="line">  dataEncipherment: true</div>
<div class="line">}]);</div>
<div class="line">cert.setExtensions(extensions);</div>
<div class="line">*/</div>
<div class="line">// self-sign certificate</div>
<div class="line">cert.sign(keys.privateKey);</div>
<div class="line"> </div>
<div class="line">// convert a Forge certificate to PEM</div>
<div class="line">var pem = pki.certificateToPem(cert);</div>
<div class="line"> </div>
<div class="line">// convert a Forge certificate from PEM</div>
<div class="line">var cert = pki.certificateFromPem(pem);</div>
<div class="line"> </div>
<div class="line">// convert an ASN.1 X.509x3 object to a Forge certificate</div>
<div class="line">var cert = pki.certificateFromAsn1(obj);</div>
<div class="line"> </div>
<div class="line">// convert a Forge certificate to an ASN.1 X.509v3 object</div>
<div class="line">var asn1Cert = pki.certificateToAsn1(cert);</div>
</div><!-- fragment --><p><a class="anchor" id="pkcs5"></a></p>
<h2><a class="anchor" id="autotoc_md17415"></a>
PKCS#5</h2>
<p>Provides the password-based key-derivation function from <a href="https://en.wikipedia.org/wiki/PKCS">PKCS#5</a>.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate a password-based 16-byte key</div>
<div class="line">// note an optional message digest can be passed as the final parameter</div>
<div class="line">var salt = forge.random.getBytesSync(128);</div>
<div class="line">var derivedKey = forge.pkcs5.pbkdf2(&#39;password&#39;, salt, numIterations, 16);</div>
<div class="line"> </div>
<div class="line">// generate key asynchronously</div>
<div class="line">// note an optional message digest can be passed before the callback</div>
<div class="line">forge.pkcs5.pbkdf2(&#39;password&#39;, salt, numIterations, 16, function(err, derivedKey) {</div>
<div class="line">  // do something w/derivedKey</div>
<div class="line">});</div>
</div><!-- fragment --><p><a class="anchor" id="pkcs7"></a></p>
<h2><a class="anchor" id="autotoc_md17416"></a>
PKCS#7</h2>
<p>Provides cryptographically protected messages from <a href="https://en.wikipedia.org/wiki/Cryptographic_Message_Syntax">PKCS#7</a>.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// convert a message from PEM</div>
<div class="line">var p7 = forge.pkcs7.messageFromPem(pem);</div>
<div class="line">// look at p7.recipients</div>
<div class="line"> </div>
<div class="line">// find a recipient by the issuer of a certificate</div>
<div class="line">var recipient = p7.findRecipient(cert);</div>
<div class="line"> </div>
<div class="line">// decrypt</div>
<div class="line">p7.decrypt(p7.recipients[0], privateKey);</div>
<div class="line"> </div>
<div class="line">// create a p7 enveloped message</div>
<div class="line">var p7 = forge.pkcs7.createEnvelopedData();</div>
<div class="line"> </div>
<div class="line">// add a recipient</div>
<div class="line">var cert = forge.pki.certificateFromPem(certPem);</div>
<div class="line">p7.addRecipient(cert);</div>
<div class="line"> </div>
<div class="line">// set content</div>
<div class="line">p7.content = forge.util.createBuffer(&#39;Hello&#39;);</div>
<div class="line"> </div>
<div class="line">// encrypt</div>
<div class="line">p7.encrypt();</div>
<div class="line"> </div>
<div class="line">// convert message to PEM</div>
<div class="line">var pem = forge.pkcs7.messageToPem(p7);</div>
<div class="line"> </div>
<div class="line">// create a degenerate PKCS#7 certificate container</div>
<div class="line">// (CRLs not currently supported, only certificates)</div>
<div class="line">var p7 = forge.pkcs7.createSignedData();</div>
<div class="line">p7.addCertificate(certOrCertPem1);</div>
<div class="line">p7.addCertificate(certOrCertPem2);</div>
<div class="line">var pem = forge.pkcs7.messageToPem(p7);</div>
<div class="line"> </div>
<div class="line">// create PKCS#7 signed data with authenticatedAttributes</div>
<div class="line">// attributes include: PKCS#9 content-type, message-digest, and signing-time</div>
<div class="line">var p7 = forge.pkcs7.createSignedData();</div>
<div class="line">p7.content = forge.util.createBuffer(&#39;Some content to be signed.&#39;, &#39;utf8&#39;);</div>
<div class="line">p7.addCertificate(certOrCertPem);</div>
<div class="line">p7.addSigner({</div>
<div class="line">  key: privateKeyAssociatedWithCert,</div>
<div class="line">  certificate: certOrCertPem,</div>
<div class="line">  digestAlgorithm: forge.pki.oids.sha256,</div>
<div class="line">  authenticatedAttributes: [{</div>
<div class="line">    type: forge.pki.oids.contentType,</div>
<div class="line">    value: forge.pki.oids.data</div>
<div class="line">  }, {</div>
<div class="line">    type: forge.pki.oids.messageDigest</div>
<div class="line">    // value will be auto-populated at signing time</div>
<div class="line">  }, {</div>
<div class="line">    type: forge.pki.oids.signingTime,</div>
<div class="line">    // value can also be auto-populated at signing time</div>
<div class="line">    value: new Date()</div>
<div class="line">  }]</div>
<div class="line">});</div>
<div class="line">p7.sign();</div>
<div class="line">var pem = forge.pkcs7.messageToPem(p7);</div>
<div class="line"> </div>
<div class="line">// PKCS#7 Sign in detached mode.</div>
<div class="line">// Includes the signature and certificate without the signed data.</div>
<div class="line">p7.sign({detached: true});</div>
</div><!-- fragment --><p><a class="anchor" id="pkcs8"></a></p>
<h2><a class="anchor" id="autotoc_md17417"></a>
PKCS#8</h2>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var pki = forge.pki;</div>
<div class="line"> </div>
<div class="line">// convert a PEM-formatted private key to a Forge private key</div>
<div class="line">var privateKey = pki.privateKeyFromPem(pem);</div>
<div class="line"> </div>
<div class="line">// convert a Forge private key to PEM-format</div>
<div class="line">var pem = pki.privateKeyToPem(privateKey);</div>
<div class="line"> </div>
<div class="line">// convert an ASN.1 PrivateKeyInfo or RSAPrivateKey to a Forge private key</div>
<div class="line">var privateKey = pki.privateKeyFromAsn1(rsaPrivateKey);</div>
<div class="line"> </div>
<div class="line">// convert a Forge private key to an ASN.1 RSAPrivateKey</div>
<div class="line">var rsaPrivateKey = pki.privateKeyToAsn1(privateKey);</div>
<div class="line"> </div>
<div class="line">// wrap an RSAPrivateKey ASN.1 object in a PKCS#8 ASN.1 PrivateKeyInfo</div>
<div class="line">var privateKeyInfo = pki.wrapRsaPrivateKey(rsaPrivateKey);</div>
<div class="line"> </div>
<div class="line">// convert a PKCS#8 ASN.1 PrivateKeyInfo to PEM</div>
<div class="line">var pem = pki.privateKeyInfoToPem(privateKeyInfo);</div>
<div class="line"> </div>
<div class="line">// encrypts a PrivateKeyInfo using a custom password and</div>
<div class="line">// outputs an EncryptedPrivateKeyInfo</div>
<div class="line">var encryptedPrivateKeyInfo = pki.encryptPrivateKeyInfo(</div>
<div class="line">  privateKeyInfo, &#39;myCustomPasswordHere&#39;, {</div>
<div class="line">    algorithm: &#39;aes256&#39;, // &#39;aes128&#39;, &#39;aes192&#39;, &#39;aes256&#39;, &#39;3des&#39;</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">// decrypts an ASN.1 EncryptedPrivateKeyInfo that was encrypted</div>
<div class="line">// with a custom password</div>
<div class="line">var privateKeyInfo = pki.decryptPrivateKeyInfo(</div>
<div class="line">  encryptedPrivateKeyInfo, &#39;myCustomPasswordHere&#39;);</div>
<div class="line"> </div>
<div class="line">// converts an EncryptedPrivateKeyInfo to PEM</div>
<div class="line">var pem = pki.encryptedPrivateKeyToPem(encryptedPrivateKeyInfo);</div>
<div class="line"> </div>
<div class="line">// converts a PEM-encoded EncryptedPrivateKeyInfo to ASN.1 format</div>
<div class="line">var encryptedPrivateKeyInfo = pki.encryptedPrivateKeyFromPem(pem);</div>
<div class="line"> </div>
<div class="line">// wraps and encrypts a Forge private key and outputs it in PEM format</div>
<div class="line">var pem = pki.encryptRsaPrivateKey(privateKey, &#39;password&#39;);</div>
<div class="line"> </div>
<div class="line">// encrypts a Forge private key and outputs it in PEM format using OpenSSL&#39;s</div>
<div class="line">// proprietary legacy format + encapsulated PEM headers (DEK-Info)</div>
<div class="line">var pem = pki.encryptRsaPrivateKey(privateKey, &#39;password&#39;, {legacy: true});</div>
<div class="line"> </div>
<div class="line">// decrypts a PEM-formatted, encrypted private key</div>
<div class="line">var privateKey = pki.decryptRsaPrivateKey(pem, &#39;password&#39;);</div>
<div class="line"> </div>
<div class="line">// sets an RSA public key from a private key</div>
<div class="line">var publicKey = pki.setRsaPublicKey(privateKey.n, privateKey.e);</div>
</div><!-- fragment --><p><a class="anchor" id="pkcs10"></a></p>
<h2><a class="anchor" id="autotoc_md17418"></a>
PKCS#10</h2>
<p>Provides certification requests or certificate signing requests (CSR) from <a href="https://en.wikipedia.org/wiki/Certificate_signing_request">PKCS#10</a>.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate a key pair</div>
<div class="line">var keys = forge.pki.rsa.generateKeyPair(1024);</div>
<div class="line"> </div>
<div class="line">// create a certification request (CSR)</div>
<div class="line">var csr = forge.pki.createCertificationRequest();</div>
<div class="line">csr.publicKey = keys.publicKey;</div>
<div class="line">csr.setSubject([{</div>
<div class="line">  name: &#39;commonName&#39;,</div>
<div class="line">  value: &#39;example.org&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;countryName&#39;,</div>
<div class="line">  value: &#39;US&#39;</div>
<div class="line">}, {</div>
<div class="line">  shortName: &#39;ST&#39;,</div>
<div class="line">  value: &#39;Virginia&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;localityName&#39;,</div>
<div class="line">  value: &#39;Blacksburg&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;organizationName&#39;,</div>
<div class="line">  value: &#39;Test&#39;</div>
<div class="line">}, {</div>
<div class="line">  shortName: &#39;OU&#39;,</div>
<div class="line">  value: &#39;Test&#39;</div>
<div class="line">}]);</div>
<div class="line">// set (optional) attributes</div>
<div class="line">csr.setAttributes([{</div>
<div class="line">  name: &#39;challengePassword&#39;,</div>
<div class="line">  value: &#39;password&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;unstructuredName&#39;,</div>
<div class="line">  value: &#39;My Company, Inc.&#39;</div>
<div class="line">}, {</div>
<div class="line">  name: &#39;extensionRequest&#39;,</div>
<div class="line">  extensions: [{</div>
<div class="line">    name: &#39;subjectAltName&#39;,</div>
<div class="line">    altNames: [{</div>
<div class="line">      // 2 is DNS type</div>
<div class="line">      type: 2,</div>
<div class="line">      value: &#39;test.domain.com&#39;</div>
<div class="line">    }, {</div>
<div class="line">      type: 2,</div>
<div class="line">      value: &#39;other.domain.com&#39;,</div>
<div class="line">    }, {</div>
<div class="line">      type: 2,</div>
<div class="line">      value: &#39;www.domain.net&#39;</div>
<div class="line">    }]</div>
<div class="line">  }]</div>
<div class="line">}]);</div>
<div class="line"> </div>
<div class="line">// sign certification request</div>
<div class="line">csr.sign(keys.privateKey);</div>
<div class="line"> </div>
<div class="line">// verify certification request</div>
<div class="line">var verified = csr.verify();</div>
<div class="line"> </div>
<div class="line">// convert certification request to PEM-format</div>
<div class="line">var pem = forge.pki.certificationRequestToPem(csr);</div>
<div class="line"> </div>
<div class="line">// convert a Forge certification request from PEM-format</div>
<div class="line">var csr = forge.pki.certificationRequestFromPem(pem);</div>
<div class="line"> </div>
<div class="line">// get an attribute</div>
<div class="line">csr.getAttribute({name: &#39;challengePassword&#39;});</div>
<div class="line"> </div>
<div class="line">// get extensions array</div>
<div class="line">csr.getAttribute({name: &#39;extensionRequest&#39;}).extensions;</div>
</div><!-- fragment --><p><a class="anchor" id="pkcs12"></a></p>
<h2><a class="anchor" id="autotoc_md17419"></a>
PKCS#12</h2>
<p>Provides the cryptographic archive file format from <a href="https://en.wikipedia.org/wiki/PKCS_%E2%99%AF12">PKCS#12</a>.</p>
<p><b>Note for Chrome/Firefox/iOS/similar users</b>: If you have trouble importing a PKCS#12 container, try using the TripleDES algorithm. It can be passed to <code>forge.pkcs12.toPkcs12Asn1</code> using the &lsquo;{algorithm: '3des&rsquo;}` option.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// decode p12 from base64</div>
<div class="line">var p12Der = forge.util.decode64(p12b64);</div>
<div class="line">// get p12 as ASN.1 object</div>
<div class="line">var p12Asn1 = forge.asn1.fromDer(p12Der);</div>
<div class="line">// decrypt p12 using the password &#39;password&#39;</div>
<div class="line">var p12 = forge.pkcs12.pkcs12FromAsn1(p12Asn1, &#39;password&#39;);</div>
<div class="line">// decrypt p12 using non-strict parsing mode (resolves some ASN.1 parse errors)</div>
<div class="line">var p12 = forge.pkcs12.pkcs12FromAsn1(p12Asn1, false, &#39;password&#39;);</div>
<div class="line">// decrypt p12 using literally no password (eg: Mac OS X/apple push)</div>
<div class="line">var p12 = forge.pkcs12.pkcs12FromAsn1(p12Asn1);</div>
<div class="line">// decrypt p12 using an &quot;empty&quot; password (eg: OpenSSL with no password input)</div>
<div class="line">var p12 = forge.pkcs12.pkcs12FromAsn1(p12Asn1, &#39;&#39;);</div>
<div class="line">// p12.safeContents is an array of safe contents, each of</div>
<div class="line">// which contains an array of safeBags</div>
<div class="line"> </div>
<div class="line">// get bags by friendlyName</div>
<div class="line">var bags = p12.getBags({friendlyName: &#39;test&#39;});</div>
<div class="line">// bags are key&#39;d by attribute type (here &quot;friendlyName&quot;)</div>
<div class="line">// and the key values are an array of matching objects</div>
<div class="line">var cert = bags.friendlyName[0];</div>
<div class="line"> </div>
<div class="line">// get bags by localKeyId</div>
<div class="line">var bags = p12.getBags({localKeyId: buffer});</div>
<div class="line">// bags are key&#39;d by attribute type (here &quot;localKeyId&quot;)</div>
<div class="line">// and the key values are an array of matching objects</div>
<div class="line">var cert = bags.localKeyId[0];</div>
<div class="line"> </div>
<div class="line">// get bags by localKeyId (input in hex)</div>
<div class="line">var bags = p12.getBags({localKeyIdHex: &#39;7b59377ff142d0be4565e9ac3d396c01401cd879&#39;});</div>
<div class="line">// bags are key&#39;d by attribute type (here &quot;localKeyId&quot;, *not* &quot;localKeyIdHex&quot;)</div>
<div class="line">// and the key values are an array of matching objects</div>
<div class="line">var cert = bags.localKeyId[0];</div>
<div class="line"> </div>
<div class="line">// get bags by type</div>
<div class="line">var bags = p12.getBags({bagType: forge.pki.oids.certBag});</div>
<div class="line">// bags are key&#39;d by bagType and each bagType key&#39;s value</div>
<div class="line">// is an array of matches (in this case, certificate objects)</div>
<div class="line">var cert = bags[forge.pki.oids.certBag][0];</div>
<div class="line"> </div>
<div class="line">// get bags by friendlyName and filter on bag type</div>
<div class="line">var bags = p12.getBags({</div>
<div class="line">  friendlyName: &#39;test&#39;,</div>
<div class="line">  bagType: forge.pki.oids.certBag</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// get key bags</div>
<div class="line">var bags = p12.getBags({bagType: forge.pki.oids.keyBag});</div>
<div class="line">// get key</div>
<div class="line">var bag = bags[forge.pki.oids.keyBag][0];</div>
<div class="line">var key = bag.key;</div>
<div class="line">// if the key is in a format unrecognized by forge then</div>
<div class="line">// bag.key will be `null`, use bag.asn1 to get the ASN.1</div>
<div class="line">// representation of the key</div>
<div class="line">if(bag.key === null) {</div>
<div class="line">  var keyAsn1 = bag.asn1;</div>
<div class="line">  // can now convert back to DER/PEM/etc for export</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// generate a p12 using AES (default)</div>
<div class="line">var p12Asn1 = forge.pkcs12.toPkcs12Asn1(</div>
<div class="line">  privateKey, certificateChain, &#39;password&#39;);</div>
<div class="line"> </div>
<div class="line">// generate a p12 that can be imported by Chrome/Firefox/iOS</div>
<div class="line">// (requires the use of Triple DES instead of AES)</div>
<div class="line">var p12Asn1 = forge.pkcs12.toPkcs12Asn1(</div>
<div class="line">  privateKey, certificateChain, &#39;password&#39;,</div>
<div class="line">  {algorithm: &#39;3des&#39;});</div>
<div class="line"> </div>
<div class="line">// base64-encode p12</div>
<div class="line">var p12Der = forge.asn1.toDer(p12Asn1).getBytes();</div>
<div class="line">var p12b64 = forge.util.encode64(p12Der);</div>
<div class="line"> </div>
<div class="line">// create download link for p12</div>
<div class="line">var a = document.createElement(&#39;a&#39;);</div>
<div class="line">a.download = &#39;example.p12&#39;;</div>
<div class="line">a.setAttribute(&#39;href&#39;, &#39;data:application/x-pkcs12;base64,&#39; + p12b64);</div>
<div class="line">a.appendChild(document.createTextNode(&#39;Download&#39;));</div>
</div><!-- fragment --><p><a class="anchor" id="asn"></a></p>
<h2><a class="anchor" id="autotoc_md17420"></a>
ASN.1</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/ASN.1">ASN.1</a> DER encoding and decoding.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var asn1 = forge.asn1;</div>
<div class="line"> </div>
<div class="line">// create a SubjectPublicKeyInfo</div>
<div class="line">var subjectPublicKeyInfo =</div>
<div class="line">  asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [</div>
<div class="line">    // AlgorithmIdentifier</div>
<div class="line">    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [</div>
<div class="line">      // algorithm</div>
<div class="line">      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.OID, false,</div>
<div class="line">        asn1.oidToDer(pki.oids[&#39;rsaEncryption&#39;]).getBytes()),</div>
<div class="line">      // parameters (null)</div>
<div class="line">      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.NULL, false, &#39;&#39;)</div>
<div class="line">    ]),</div>
<div class="line">    // subjectPublicKey</div>
<div class="line">    asn1.create(asn1.Class.UNIVERSAL, asn1.Type.BITSTRING, false, [</div>
<div class="line">      // RSAPublicKey</div>
<div class="line">      asn1.create(asn1.Class.UNIVERSAL, asn1.Type.SEQUENCE, true, [</div>
<div class="line">        // modulus (n)</div>
<div class="line">        asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,</div>
<div class="line">          _bnToBytes(key.n)),</div>
<div class="line">        // publicExponent (e)</div>
<div class="line">        asn1.create(asn1.Class.UNIVERSAL, asn1.Type.INTEGER, false,</div>
<div class="line">          _bnToBytes(key.e))</div>
<div class="line">      ])</div>
<div class="line">    ])</div>
<div class="line">  ]);</div>
<div class="line"> </div>
<div class="line">// serialize an ASN.1 object to DER format</div>
<div class="line">var derBuffer = asn1.toDer(subjectPublicKeyInfo);</div>
<div class="line"> </div>
<div class="line">// deserialize to an ASN.1 object from a byte buffer filled with DER data</div>
<div class="line">var object = asn1.fromDer(derBuffer);</div>
<div class="line"> </div>
<div class="line">// convert an OID dot-separated string to a byte buffer</div>
<div class="line">var derOidBuffer = asn1.oidToDer(&#39;1.2.840.113549.1.1.5&#39;);</div>
<div class="line"> </div>
<div class="line">// convert a byte buffer with a DER-encoded OID to a dot-separated string</div>
<div class="line">console.log(asn1.derToOid(derOidBuffer));</div>
<div class="line">// output: 1.2.840.113549.1.1.5</div>
<div class="line"> </div>
<div class="line">// validates that an ASN.1 object matches a particular ASN.1 structure and</div>
<div class="line">// captures data of interest from that structure for easy access</div>
<div class="line">var publicKeyValidator = {</div>
<div class="line">  name: &#39;SubjectPublicKeyInfo&#39;,</div>
<div class="line">  tagClass: asn1.Class.UNIVERSAL,</div>
<div class="line">  type: asn1.Type.SEQUENCE,</div>
<div class="line">  constructed: true,</div>
<div class="line">  captureAsn1: &#39;subjectPublicKeyInfo&#39;,</div>
<div class="line">  value: [{</div>
<div class="line">    name: &#39;SubjectPublicKeyInfo.AlgorithmIdentifier&#39;,</div>
<div class="line">    tagClass: asn1.Class.UNIVERSAL,</div>
<div class="line">    type: asn1.Type.SEQUENCE,</div>
<div class="line">    constructed: true,</div>
<div class="line">    value: [{</div>
<div class="line">      name: &#39;AlgorithmIdentifier.algorithm&#39;,</div>
<div class="line">      tagClass: asn1.Class.UNIVERSAL,</div>
<div class="line">      type: asn1.Type.OID,</div>
<div class="line">      constructed: false,</div>
<div class="line">      capture: &#39;publicKeyOid&#39;</div>
<div class="line">    }]</div>
<div class="line">  }, {</div>
<div class="line">    // subjectPublicKey</div>
<div class="line">    name: &#39;SubjectPublicKeyInfo.subjectPublicKey&#39;,</div>
<div class="line">    tagClass: asn1.Class.UNIVERSAL,</div>
<div class="line">    type: asn1.Type.BITSTRING,</div>
<div class="line">    constructed: false,</div>
<div class="line">    value: [{</div>
<div class="line">      // RSAPublicKey</div>
<div class="line">      name: &#39;SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey&#39;,</div>
<div class="line">      tagClass: asn1.Class.UNIVERSAL,</div>
<div class="line">      type: asn1.Type.SEQUENCE,</div>
<div class="line">      constructed: true,</div>
<div class="line">      optional: true,</div>
<div class="line">      captureAsn1: &#39;rsaPublicKey&#39;</div>
<div class="line">    }]</div>
<div class="line">  }]</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">var capture = {};</div>
<div class="line">var errors = [];</div>
<div class="line">if(!asn1.validate(</div>
<div class="line">  publicKeyValidator, subjectPublicKeyInfo, validator, capture, errors)) {</div>
<div class="line">  throw &#39;ASN.1 object is not a SubjectPublicKeyInfo.&#39;;</div>
<div class="line">}</div>
<div class="line">// capture.subjectPublicKeyInfo contains the full ASN.1 object</div>
<div class="line">// capture.rsaPublicKey contains the full ASN.1 object for the RSA public key</div>
<div class="line">// capture.publicKeyOid only contains the value for the OID</div>
<div class="line">var oid = asn1.derToOid(capture.publicKeyOid);</div>
<div class="line">if(oid !== pki.oids[&#39;rsaEncryption&#39;]) {</div>
<div class="line">  throw &#39;Unsupported OID.&#39;;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// pretty print an ASN.1 object to a string for debugging purposes</div>
<div class="line">asn1.prettyPrint(object);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17421"></a>
Message Digests</h1>
<p><a class="anchor" id="sha1"></a></p>
<h2><a class="anchor" id="autotoc_md17422"></a>
SHA1</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/SHA-1">SHA-1</a> message digests.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var md = forge.md.sha1.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: 2fd4e1c67a2d28fced849ee1bb76e7391b93eb12</div>
</div><!-- fragment --><p><a class="anchor" id="sha256"></a></p>
<h2><a class="anchor" id="autotoc_md17423"></a>
SHA256</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/SHA-256">SHA-256</a> message digests.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var md = forge.md.sha256.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: d7a8fbb307d7809469ca9abcb0082e4f8d5651e46d3cdb762d02d0bf37c9e592</div>
</div><!-- fragment --><p><a class="anchor" id="sha384"></a></p>
<h2><a class="anchor" id="autotoc_md17424"></a>
SHA384</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/SHA-384">SHA-384</a> message digests.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var md = forge.md.sha384.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: ca737f1014a48f4c0b6dd43cb177b0afd9e5169367544c494011e3317dbf9a509cb1e5dc1e85a941bbee3d7f2afbc9b1</div>
</div><!-- fragment --><p><a class="anchor" id="sha512"></a></p>
<h2><a class="anchor" id="autotoc_md17425"></a>
SHA512</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/SHA-512">SHA-512</a> message digests.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// SHA-512</div>
<div class="line">var md = forge.md.sha512.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: 07e547d9586f6a73f73fbac0435ed76951218fb7d0c8d788a309d785436bbb642e93a252a954f23912547d1e8a3b5ed6e1bfd7097821233fa0538f3db854fee6</div>
<div class="line"> </div>
<div class="line">// SHA-512/224</div>
<div class="line">var md = forge.md.sha512.sha224.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: 944cd2847fb54558d4775db0485a50003111c8e5daa63fe722c6aa37</div>
<div class="line"> </div>
<div class="line">// SHA-512/256</div>
<div class="line">var md = forge.md.sha512.sha256.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: dd9d67b371519c339ed8dbd25af90e976a1eeefd4ad3d889005e532fc5bef04d</div>
</div><!-- fragment --><p><a class="anchor" id="md5"></a></p>
<h2><a class="anchor" id="autotoc_md17426"></a>
MD5</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/MD5">MD5</a> message digests.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var md = forge.md.md5.create();</div>
<div class="line">md.update(&#39;The quick brown fox jumps over the lazy dog&#39;);</div>
<div class="line">console.log(md.digest().toHex());</div>
<div class="line">// output: 9e107d9d372bb6826bd81d3542a419d6</div>
</div><!-- fragment --><p><a class="anchor" id="hmac"></a></p>
<h2><a class="anchor" id="autotoc_md17427"></a>
HMAC</h2>
<p>Provides <a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a> w/any supported message digest algorithm.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">var hmac = forge.hmac.create();</div>
<div class="line">hmac.start(&#39;sha1&#39;, &#39;Jefe&#39;);</div>
<div class="line">hmac.update(&#39;what do ya want for nothing?&#39;);</div>
<div class="line">console.log(hmac.digest().toHex());</div>
<div class="line">// output: effcdf6ae5eb2fa2d27416d5f184df9c259a7c79</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17428"></a>
Utilities</h1>
<p><a class="anchor" id="prime"></a></p>
<h2><a class="anchor" id="autotoc_md17429"></a>
Prime</h2>
<p>Provides an API for generating large, random, probable primes.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// generate a random prime on the main JS thread</div>
<div class="line">var bits = 1024;</div>
<div class="line">forge.prime.generateProbablePrime(bits, function(err, num) {</div>
<div class="line">  console.log(&#39;random prime&#39;, num.toString(16));</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// generate a random prime using Web Workers (if available, otherwise</div>
<div class="line">// falls back to the main thread)</div>
<div class="line">var bits = 1024;</div>
<div class="line">var options = {</div>
<div class="line">  algorithm: {</div>
<div class="line">    name: &#39;PRIMEINC&#39;,</div>
<div class="line">    workers: -1 // auto-optimize # of workers</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line">forge.prime.generateProbablePrime(bits, options, function(err, num) {</div>
<div class="line">  console.log(&#39;random prime&#39;, num.toString(16));</div>
<div class="line">});</div>
</div><!-- fragment --><p><a class="anchor" id="prng"></a></p>
<h2><a class="anchor" id="autotoc_md17430"></a>
PRNG</h2>
<p>Provides a <a href="https://en.wikipedia.org/wiki/Fortuna_(PRNG)">Fortuna</a>-based cryptographically-secure pseudo-random number generator, to be used with a cryptographic function backend, e.g. <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a>. An implementation using <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> as a backend is provided. An API for collecting entropy is given, though if window.crypto.getRandomValues is available, it will be used automatically.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// get some random bytes synchronously</div>
<div class="line">var bytes = forge.random.getBytesSync(32);</div>
<div class="line">console.log(forge.util.bytesToHex(bytes));</div>
<div class="line"> </div>
<div class="line">// get some random bytes asynchronously</div>
<div class="line">forge.random.getBytes(32, function(err, bytes) {</div>
<div class="line">  console.log(forge.util.bytesToHex(bytes));</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// collect some entropy if you&#39;d like</div>
<div class="line">forge.random.collect(someRandomBytes);</div>
<div class="line">jQuery().mousemove(function(e) {</div>
<div class="line">  forge.random.collectInt(e.clientX, 16);</div>
<div class="line">  forge.random.collectInt(e.clientY, 16);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// specify a seed file for use with the synchronous API if you&#39;d like</div>
<div class="line">forge.random.seedFileSync = function(needed) {</div>
<div class="line">  // get &#39;needed&#39; number of random bytes from somewhere</div>
<div class="line">  return fetchedRandomBytes;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// specify a seed file for use with the asynchronous API if you&#39;d like</div>
<div class="line">forge.random.seedFile = function(needed, callback) {</div>
<div class="line">  // get the &#39;needed&#39; number of random bytes from somewhere</div>
<div class="line">  callback(null, fetchedRandomBytes);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// register the main thread to send entropy or a Web Worker to receive</div>
<div class="line">// entropy on demand from the main thread</div>
<div class="line">forge.random.registerWorker(self);</div>
<div class="line"> </div>
<div class="line">// generate a new instance of a PRNG with no collected entropy</div>
<div class="line">var myPrng = forge.random.createInstance();</div>
</div><!-- fragment --><p><a class="anchor" id="task"></a></p>
<h2><a class="anchor" id="autotoc_md17431"></a>
Tasks</h2>
<p>Provides queuing and synchronizing tasks in a web application.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// TODO</div>
</div><!-- fragment --><p><a class="anchor" id="util"></a></p>
<h2><a class="anchor" id="autotoc_md17432"></a>
Utilities</h2>
<p>Provides utility functions, including byte buffer support, base64, bytes to/from hex, zlib inflate/deflate, etc.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// encode/decode base64</div>
<div class="line">var encoded = forge.util.encode64(str);</div>
<div class="line">var str = forge.util.decode64(encoded);</div>
<div class="line"> </div>
<div class="line">// encode/decode UTF-8</div>
<div class="line">var encoded = forge.util.encodeUtf8(str);</div>
<div class="line">var str = forge.util.decodeUtf8(encoded);</div>
<div class="line"> </div>
<div class="line">// bytes to/from hex</div>
<div class="line">var bytes = forge.util.hexToBytes(hex);</div>
<div class="line">var hex = forge.util.bytesToHex(bytes);</div>
<div class="line"> </div>
<div class="line">// create an empty byte buffer</div>
<div class="line">var buffer = forge.util.createBuffer();</div>
<div class="line">// create a byte buffer from raw binary bytes</div>
<div class="line">var buffer = forge.util.createBuffer(input, &#39;raw&#39;);</div>
<div class="line">// create a byte buffer from utf8 bytes</div>
<div class="line">var buffer = forge.util.createBuffer(input, &#39;utf8&#39;);</div>
<div class="line"> </div>
<div class="line">// get the length of the buffer in bytes</div>
<div class="line">buffer.length();</div>
<div class="line">// put bytes into the buffer</div>
<div class="line">buffer.putBytes(bytes);</div>
<div class="line">// put a 32-bit integer into the buffer</div>
<div class="line">buffer.putInt32(10);</div>
<div class="line">// buffer to hex</div>
<div class="line">buffer.toHex();</div>
<div class="line">// get a copy of the bytes in the buffer</div>
<div class="line">bytes.bytes(/* count */);</div>
<div class="line">// empty this buffer and get its contents</div>
<div class="line">bytes.getBytes(/* count */);</div>
<div class="line"> </div>
<div class="line">// convert a forge buffer into a Node.js Buffer</div>
<div class="line">// make sure you specify the encoding as &#39;binary&#39;</div>
<div class="line">var forgeBuffer = forge.util.createBuffer();</div>
<div class="line">var nodeBuffer = Buffer.from(forgeBuffer.getBytes(), &#39;binary&#39;);</div>
<div class="line"> </div>
<div class="line">// convert a Node.js Buffer into a forge buffer</div>
<div class="line">// make sure you specify the encoding as &#39;binary&#39;</div>
<div class="line">var nodeBuffer = Buffer.from(&#39;CAFE&#39;, &#39;hex&#39;);</div>
<div class="line">var forgeBuffer = forge.util.createBuffer(nodeBuffer.toString(&#39;binary&#39;));</div>
<div class="line"> </div>
<div class="line">// parse a URL</div>
<div class="line">var parsed = forge.util.parseUrl(&#39;http://example.com/foo?bar=baz&#39;);</div>
<div class="line">// parsed.scheme, parsed.host, parsed.port, parsed.path, parsed.fullHost</div>
</div><!-- fragment --><p><a class="anchor" id="log"></a></p>
<h2><a class="anchor" id="autotoc_md17433"></a>
Logging</h2>
<p>Provides logging to a javascript console using various categories and levels of verbosity.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// TODO</div>
</div><!-- fragment --><p><a class="anchor" id="debug"></a></p>
<h2><a class="anchor" id="autotoc_md17434"></a>
Debugging</h2>
<p>Provides storage of debugging information normally inaccessible in closures for viewing/investigation.</p>
<p><b>Examples</b></p>
<div class="fragment"><div class="line">// TODO</div>
</div><!-- fragment --><p><a class="anchor" id="flash"></a></p>
<h2><a class="anchor" id="autotoc_md17435"></a>
Flash Networking Support</h2>
<p>The <a class="el" href="md_frontend_node_modules_node-forge_flash__r_e_a_d_m_e.html">flash README</a> provides details on rebuilding the optional Flash component used for networking. It also provides details on Policy Server support.</p>
<h1><a class="anchor" id="autotoc_md17436"></a>
Security Considerations</h1>
<p>When using this code please keep the following in mind:</p>
<ul>
<li>Cryptography is hard. Please review and test this code before depending on it for critical functionality.</li>
<li>The nature of JavaScript is that execution of this code depends on trusting a very large set of JavaScript tools and systems. Consider runtime variations, runtime characteristics, runtime optimization, code optimization, code minimization, code obfuscation, bundling tools, possible bugs, the Forge code itself, and so on.</li>
<li>If using pre-built bundles from <a href="https://bower.io/">Bower</a> or similar be aware someone else ran the tools to create those files.</li>
<li>Use a secure transport channel such as <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> to load scripts and consider using additional security mechanisms such as <a href="https://www.w3.org/TR/SRI/">Subresource Integrity</a> script attributes.</li>
<li>Use "native" functionality where possible. This can be critical when dealing with performance and random number generation. Note that the JavaScript random number algorithms should perform well if given suitable entropy.</li>
<li>Understand possible attacks against cryptographic systems. For instance side channel and timing attacks may be possible due to the difficulty in implementing constant time algorithms in pure JavaScript.</li>
<li>Certain features in this library are less susceptible to attacks depending on usage. This primarily includes features that deal with data format manipulation or those that are not involved in communication.</li>
</ul>
<h1><a class="anchor" id="autotoc_md17437"></a>
Library Background</h1>
<ul>
<li><a href="https://digitalbazaar.com/2010/07/20/javascript-tls-1/">https://digitalbazaar.com/2010/07/20/javascript-tls-1/</a></li>
<li><a href="https://digitalbazaar.com/2010/07/20/javascript-tls-2/">https://digitalbazaar.com/2010/07/20/javascript-tls-2/</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md17438"></a>
Contact</h1>
<ul>
<li>Code: <a href="https://github.com/digitalbazaar/forge">https://github.com/digitalbazaar/forge</a></li>
<li>Bugs: <a href="https://github.com/digitalbazaar/forge/issues">https://github.com/digitalbazaar/forge/issues</a></li>
<li>Email: <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'di'+'git'+'al'+'baz'+'aa'+'r.c'+'om'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@d<span style="display: none;">.nosp@m.</span>igita<span style="display: none;">.nosp@m.</span>lbaz<span style="display: none;">.nosp@m.</span>aar.c<span style="display: none;">.nosp@m.</span>om</a></li>
<li>IRC: <a href="https://webchat.freenode.net/?channels=#forgejs">#forgejs</a> on <a href="https://freenode.net/">freenode</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md17439"></a>
Donations</h1>
<p>Financial support is welcome and helps contribute to futher development:</p>
<ul>
<li>For <a href="https://www.paypal.com/">PayPal</a> please send to <a href="#" onclick="location.href='mai'+'lto:'+'pay'+'pa'+'l@d'+'ig'+'ita'+'lb'+'aza'+'ar'+'.co'+'m'; return false;">paypa<span style="display: none;">.nosp@m.</span>l@di<span style="display: none;">.nosp@m.</span>gital<span style="display: none;">.nosp@m.</span>baza<span style="display: none;">.nosp@m.</span>ar.co<span style="display: none;">.nosp@m.</span>m</a>.</li>
<li>Something else? Please contact <a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'di'+'git'+'al'+'baz'+'aa'+'r.c'+'om'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@d<span style="display: none;">.nosp@m.</span>igita<span style="display: none;">.nosp@m.</span>lbaz<span style="display: none;">.nosp@m.</span>aar.c<span style="display: none;">.nosp@m.</span>om</a>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
