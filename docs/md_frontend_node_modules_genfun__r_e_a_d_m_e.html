<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCDE: Genfun &lt;a href=&quot;https://travis-ci.org/zkat/genfun&quot;&gt;&lt;img src=&quot;https://img.shields.io/travis/zkat/genfun.svg&quot; alt=&quot;Travis&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://npm.im/genfun&quot;&gt;&lt;img src=&quot;https://img.shields.io/npm/v/genfun.svg&quot; alt=&quot;npm&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://npm.im/genfun&quot;&gt;&lt;img src=&quot;https://img.shields.io/npm/l/genfun.svg&quot; alt=&quot;npm&quot;/&gt;&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OCDE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_frontend_node_modules_genfun__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Genfun <a href="https://travis-ci.org/zkat/genfun"><img src="https://img.shields.io/travis/zkat/genfun.svg" alt="Travis" style="pointer-events: none;" class="inline"/></a> <a href="https://npm.im/genfun"><img src="https://img.shields.io/npm/v/genfun.svg" alt="npm" style="pointer-events: none;" class="inline"/></a> <a href="https://npm.im/genfun"><img src="https://img.shields.io/npm/l/genfun.svg" alt="npm" style="pointer-events: none;" class="inline"/></a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/zkat/genfun"><code>genfun</code></a> is a Javascript library that lets you define generic functions: regular-seeming functions that can be invoked just like any other function, but that automatically dispatch methods based on the combination of arguments passed to it when it's called, also known as multiple dispatch.</p>
<p>It was inspired by <a href="http://slatelanguage.org/">Slate</a>, <a href="http://en.wikipedia.org/wiki/CLOS">CLOS</a> and <a href="http://github.com/zkat/sheeple">Sheeple</a>.</p>
<h1><a class="anchor" id="autotoc_md10560"></a>
Install</h1>
<p><code>$ npm install genfun</code></p>
<h1><a class="anchor" id="autotoc_md10561"></a>
Table of Contents</h1>
<ul>
<li><a href="#example">Example</a></li>
<li><a href="#api">API</a><ul>
<li><a href="#genfun"><code>Genfun()</code></a></li>
<li><a href="#addMethod"><code>gf.add()</code></a></li>
<li><a href="#callNextMethod"><code>Genfun.callNextMethod()</code></a></li>
<li><a href="#noApplicableMethod"><code>Genfun.noApplicableMethod()</code></a></li>
</ul>
</li>
<li><a href="#performance">Performance</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md10562"></a>
Example</h2>
<p>Various examples are available to look at in the examples/ folder included in this project. Most examples are also runnable by just invoking them with node.</p>
<div class="fragment"><div class="line">import Genfun from &quot;genfun&quot;</div>
<div class="line"> </div>
<div class="line">class Person {}</div>
<div class="line">class Dog {}</div>
<div class="line"> </div>
<div class="line">const frobnicate = Genfun()</div>
<div class="line"> </div>
<div class="line">frobnicate.add([Person], (person) =&gt; {</div>
<div class="line">  console.log(&#39;Got a person!&#39;)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">frobnicate.add([Dog], (dog) =&gt; {</div>
<div class="line">  console.log(&#39;Got a dog!&#39;)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">frobnicate.add([String, Person, Dog], (greeting, person, dog) =&gt; {</div>
<div class="line">  console.log(person, &#39; greets &#39;, dog, &#39;, \&#39;&#39; + greeting + &#39;\&#39;&#39;)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">const person = new Person()</div>
<div class="line">const dog = new Dog()</div>
<div class="line"> </div>
<div class="line">frobnicate(person) // Got a person!</div>
<div class="line">frobnicate(dog) // Got a dog!</div>
<div class="line">frobnicate(&#39;Hi, dog!&#39;, person, dog); // {} greets {}, &#39;Hi, dog!&#39;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10563"></a>
API</h2>
<p>The basic API for <code>Genfun</code> is fairly simple: You create a new <code>genfun</code> by calling <code>Genfun()</code>, and add methods to them. Then you call the <code>genfun</code> object like a regular function, and it takes care of dispatching the appropriate methods!</p>
<h3><a class="anchor" id="autotoc_md10564"></a>
&lt;tt&gt;Genfun()&lt;/tt&gt;</h3>
<p>Takes no arguments. Simply creates a new <code>genfun</code>. A <code>genfun</code> is a regular function object with overriden function call/dispatch behavior.</p>
<p>When called, it will look at its arguments and determine if a matching method has been defined that applies to <b>all</b> arguments passed in, considered together.</p>
<p>New methods may be added to the <code>genfun</code> object with <a href="#addMethod"><code>gf.add()</code></a>.</p>
<p>If no method is found, or none has been defined, it will invoke <a href="#noApplicableMethod"><code>Genfun.noApplicableMethod</code></a> with the appropriate arguments.</p>
<p>Genfuns preserve the value of <code>this</code> if invoked using <code>.call</code> or <code>.apply</code>.</p>
<h4><a class="anchor" id="autotoc_md10565"></a>
Example</h4>
<div class="fragment"><div class="line">var gf = Genfun()</div>
<div class="line"> </div>
<div class="line">//... add some methods ..</div>
<div class="line"> </div>
<div class="line">// These calls are all identical.</div>
<div class="line">gf(1, 2, 3)</div>
<div class="line">gf.call(null, 1, 2, 3)</div>
<div class="line">gf.apply(null, [1, 2, 3])</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10566"></a>
&lt;a name="addMethod"&gt;&lt;/a&gt; &lt;tt&gt;gf.add(&lt;selector&gt;, &lt;body&gt;)&lt;/tt&gt;</h3>
<p>Adds a new method to <code>gf</code> and returns <code>gf</code> to allow chaining multiple <code>add</code>s.</p>
<p><code>&lt;selector&gt;</code> must be an array of objects that will receive new <code>Role</code>s (dispatch positions) for the method. If an object in the selector is a function, its <code>.prototype</code> field will receive the new <code>Role</code>. The array must not contain any frozen objects.</p>
<p>When a <code>genfun</code> is called (like a function), it will look at its set of added methods and, based on the <code>Role</code>s assigned, and corresponding prototype chains, will determine which method, if any, will be invoked. On invocation, a method's <code>&lt;body&gt;</code> argument will be the called with the arguments passed to the <code>genfun</code>, including its <code>this</code> and <code>arguments</code> values`.</p>
<p>Within the <code>&lt;body&gt;</code>, <a href="#callNextMethod"><code>Genfun.callNextMethod</code></a> may be called.</p>
<h4><a class="anchor" id="autotoc_md10567"></a>
Example</h4>
<div class="fragment"><div class="line">var numStr = Genfun()</div>
<div class="line"> </div>
<div class="line">numStr.add([String, Number], function (str, num) {</div>
<div class="line">  console.log(&#39;got a str:&#39;, str, &#39;and a num: &#39;, num)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">numStr.add([Number, String], function (num, str) {</div>
<div class="line">  console.log(&#39;got a num:&#39;, num, &#39;and a str:&#39;, str)</div>
<div class="line">})</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10568"></a>
&lt;a name="callNextMethod"&gt;&lt;/a&gt; &lt;tt&gt;Genfun.callNextMethod([...&lt;arguments&gt;])&lt;/tt&gt;</h3>
<p><b>NOTE</b>: This function can only be called synchronously. To call it asynchronously (for example, in a <code>Promise</code> or in a callback), use <a href="#getContext"><code>getContext</code></a></p>
<p>Calls the "next" applicable method in the method chain. Can only be called within the body of a method.</p>
<p>If no arguments are given, <code>callNextMethod</code> will pass the current method's original arguments to the next method.</p>
<p>If arguments are passed to <code>callNextMethod</code>, it will invoke the next applicable method (based on the <b>original</b> method list calculation), with <b>the given arguments</b>, even if they would otherwise not have triggered that method.</p>
<p>Returns whatever value the next method returns.</p>
<p>There <b>must</b> be a next method available when invoked. This function <b>will not</b> call <code>noApplicableMethod</code> when it runs out of methods to call. It will instead throw an error.</p>
<h4><a class="anchor" id="autotoc_md10569"></a>
Example</h4>
<div class="fragment"><div class="line">class Foo {}</div>
<div class="line">class Bar extends Foo {}</div>
<div class="line"> </div>
<div class="line">var cnm = Genfun()</div>
<div class="line"> </div>
<div class="line">cnm.add([Foo], function (foo) {</div>
<div class="line">  console.log(&#39;calling the method on Foo with&#39;, foo)</div>
<div class="line">  return foo</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">cnm.add([Bar], function (bar) {</div>
<div class="line">  console.log(&#39;calling the method on Bar with&#39;, bar)</div>
<div class="line">  return Genfun.callNextMethod(&#39;some other value!&#39;)</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">cnm(new Bar())</div>
<div class="line">// calling the method on Bar with {}</div>
<div class="line">// calling the method on Foo with &quot;some other value!&quot;</div>
<div class="line">// =&gt; &#39;some other value!&#39;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10570"></a>
&lt;a name="getContext"&gt;&lt;/a&gt; &lt;tt&gt;Genfun.getContext()&lt;/tt&gt;</h3>
<p>The <code>context</code> returned by this function will have a <code>callNextMethod</code> method which can be used to invoke the correct next method even during asynchronous calls (for example, when used in a callback or a <code>Promise</code>).</p>
<p>This function must be called synchronously within the body of the method before any asynchronous calls, and will error if invoked outside the context of a method call.</p>
<h4><a class="anchor" id="autotoc_md10571"></a>
Example</h4>
<div class="fragment"><div class="line">someGenfun.add([MyThing], function (thing) {</div>
<div class="line">  const ctx = Genfun.getContext()</div>
<div class="line">  return somePromisedCall(thing).then(res =&gt; ctx.callNextMethod(res))</div>
<div class="line">})</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10572"></a>
&lt;a name="noApplicableMethod"&gt;&lt;/a&gt; &lt;tt&gt;Genfun.noApplicableMethod(&lt;gf&gt;, &lt;this&gt;, &lt;args&gt;)&lt;/tt&gt;</h3>
<p><code>Genfun.noApplicableMethod</code> is a <code>genfun</code> itself, which is called whenever <b>any <code>genfun</code></b> fails to find a matching method for its given arguments.</p>
<p>It will be called with the <code>genfun</code> as its first argument, then the <code>this</code> value, and then the arguments it was called with.</p>
<p>By default, this will simply throw a NoApplicableMethod error.</p>
<p>Users may override this behavior for particular <code>genfun</code> and <code>this</code> combinations, although <code>args</code> will always be an <code>Array</code>. The value returned from the dispatched <code>noApplicableMethod</code> method will be returned by <code>genfun</code> as if it had been its original method. Comparable to <a href="http://ruby-doc.org/core-2.1.0/BasicObject.html#method-i-method_missing">Ruby's <code>method_missing</code></a>.</p>
<h2><a class="anchor" id="autotoc_md10573"></a>
Performance</h2>
<p><code>Genfun</code> pulls a few caching tricks to make sure dispatch, specially for common cases, is as fast as possible.</p>
<p>How fast? Well, not much slower than native methods:</p>
<div class="fragment"><div class="line">Regular function: 30.402ms</div>
<div class="line">Native method: 28.109ms</div>
<div class="line">Singly-dispatched genfun: 64.467ms</div>
<div class="line">Double-dispatched genfun: 70.052ms</div>
<div class="line">Double-dispatched genfun with string primitive: 76.742ms</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
